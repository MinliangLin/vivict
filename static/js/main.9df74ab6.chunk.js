(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,n){e.exports=n(288)},119:function(e,t,n){},121:function(e,t,n){},143:function(e,t){},145:function(e,t){},284:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(51),o=n.n(r),s=(n(119),n(17)),u=n(18),c=n(20),l=n(19),h=n(21),p=(n(120),n(121),n(2)),f=n.n(p),d=n(7),m=n(33),v=n(113),g=n(12),y=n(105),S=n(15),E=n.n(S),k=n(13),b=function(e){var t=e.onPlay,n=e.onStep,a=e.onFullscreen,r=e.playing,o=e.onSeek,s=e.position,u=e.duration;return i.a.createElement("div",{className:"controls"},i.a.createElement("button",{className:"btn btn-default",onClick:function(e){n(-1),e.stopPropagation()}},i.a.createElement(k.g,null)),i.a.createElement("button",{className:E()("btn","btn-default"),onClick:function(e){console.log("play/pause: "),t(),e.stopPropagation()}},r?i.a.createElement(k.e,null):i.a.createElement(k.f,null)),i.a.createElement("button",{className:"btn btn-default",onClick:function(e){n(1),e.stopPropagation()}},i.a.createElement(k.h,null)),i.a.createElement("input",{type:"range",value:s,min:"0",max:u,step:"0.04",onInput:function(e){console.log("range value: ".concat(e.target.value));var t=parseFloat(e.target.value);o(t),e.stopPropagation()}}),i.a.createElement("button",{className:"btn btn-default glyphicon glyphicon-fullscreen",onClick:function(e){a(),e.stopPropagation()}},i.a.createElement(k.d,null)))},w=n(108),O=n.n(w),V=n(109),P=n.n(V),R=n(52),C=n(110);function T(e){return!!e&&e.split("?")[0].endsWith(".m3u8")}function N(e){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(f.a.mark(function e(t){var n,a,i,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,(i=new C.a).push(a),i.end(),r=i.manifest,o=r.playlists.map(function(e){return Object(R.a)({url:x(t,e.uri),bandwidth:e.attributes.BANDWIDTH},e.attributes.RESOLUTION)}),e.abrupt("return",{mainUrl:t,variants:o,selectedVariant:0});case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e,t){return 0===(n=t).indexOf("http://")||0===n.indexOf("https://")?t:e.replace(/\/[^/]*$/,"/"+t);var n}var I=n(111);function A(e){return _.apply(this,arguments)}function _(){return(_=Object(d.a)(f.a.mark(function e(t){var n,a,i,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,console.log("RAW DASH MANIFEST:"+a),i=Object(I.a)(a),console.log("DASH MANIFEST:\n"+JSON.stringify(i)),r=i.playlists.map(function(e,t){return Object(R.a)({url:null,index:t,bandwidth:e.attributes.BANDWIDTH},e.attributes.RESOLUTION)}),e.abrupt("return",{mainUrl:t,variants:r,selectedVariant:0});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e){return!!e&&e.split("?")[0].endsWith(".mpd")}var U=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={zoom:1,panHorizontal:0,panVertical:0},n.onTimeUpdate=n.onTimeUpdate.bind(Object(g.a)(n)),n.onMetadataLoaded=n.onMetadataLoaded.bind(Object(g.a)(n)),n.setVideoRef=function(e){n.videoElement=e},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"onTimeUpdate",value:function(){this.props.onTimeUpdate&&this.props.onTimeUpdate(this.videoElement.currentTime)}},{key:"onMetadataLoaded",value:function(){this.props.onDurationSet&&this.props.onDurationSet(this.videoElement.duration)}},{key:"play",value:function(){var e=Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.videoElement.play());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){this.videoElement.pause()}},{key:"quickSeek",value:function(e){this.videoElement.currentTime=e}},{key:"zoomIn",value:function(){this.zoom(1.1)}},{key:"zoomOut",value:function(){this.zoom(1/1.1)}},{key:"zoom",value:function(e){var t=(1-e)/2*document.documentElement.clientWidth+e*this.state.panHorizontal,n=(1-e)/2*document.documentElement.clientHeight+e*this.state.panVertical;this.setState({zoom:this.state.zoom*e,panHorizontal:t,panVertical:n})}},{key:"pan",value:function(e,t){this.setState({panHorizontal:this.state.panHorizontal+e,panVertical:this.state.panVertical+t})}},{key:"resetPanZoom",value:function(){var e=(document.documentElement.clientHeight-this.videoElement.offsetHeight/this.state.zoom)/2;this.setState({zoom:1,panHorizontal:0,panVertical:e})}},{key:"seek",value:function(){var e=Object(d.a)(f.a.mark(function e(t){var n=this;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>this.videoElement.duration)){e.next=2;break}return e.abrupt("return",Promise.reject("Invalid seek position: ".concat(t,", media duration is ").concat(this.videoElement.duration)));case 2:return e.abrupt("return",new Promise(function(e,a){n.videoElement.addEventListener("seeked",function(){e()},{once:!0}),n.videoElement.currentTime=t}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadSource",value:function(){var e=Object(d.a)(f.a.mark(function e(t,n){var a=this;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("load source: ".concat(t," ").concat(n)),e.abrupt("return",new Promise(function(e,i){a.videoElement.addEventListener("canplay",function(){e()},{once:!0}),T(t)?a.loadHls(t,n):j(t)?a.loadDash(t,n):a.videoElement.src=t}));case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setVariant",value:function(e){console.log("setVariant: ".concat(e)),this.state.dash?(console.log("setting quality level"),this.state.dash.setQualityFor("video",e)):this.state.hls&&(this.state.hls.currentLevel=e)}},{key:"loadDash",value:function(e,t){var n=this,a=this.state.dash;a||(a=P.a.MediaPlayer().create(),this.setState({dash:a})),a.updateSettings({streaming:{fastSwitchEnabled:!0,abr:{autoSwitchBitrate:{audio:!1,video:!1}}}}),this.videoElement.addEventListener("canplay",function(){n.state.dash.setQualityFor("video",t)},{once:!0}),a.initialize(this.videoElement,e,!1)}},{key:"loadHls",value:function(e,t){var n=this.state.hls;n||(n=new O.a,this.setState({hls:n})),n.loadSource(e),n.attachMedia(this.videoElement),n.currentLevel=t}},{key:"currentTime",value:function(){return this.videoElement.currentTime}},{key:"componentDidMount",value:function(){this.videoElement.addEventListener("timeupdate",this.onTimeUpdate),this.videoElement.addEventListener("loadedmetadata",this.onMetadataLoaded)}},{key:"componentWillUnmount",value:function(){this.videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this.videoElement.removeEventListener("loadedmetadata",this.onMetadataLoaded)}},{key:"render",value:function(){var e=parseInt(100*this.state.zoom)+"vw";return i.a.createElement("video",{muted:this.props.muted,ref:this.setVideoRef,tabIndex:"-1",style:{width:e,left:this.state.panHorizontal+"px",top:this.state.panVertical+"px"}})}}]),t}(a.Component);n(284),n(285),n(112);var F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).stopPropagation=n.stopPropagation.bind(Object(g.a)(n)),n.urlInputKeyDown=n.urlInputKeyDown.bind(Object(g.a)(n)),n.state={source:n.props.defaultSource,metadata:null,showUrlInput:!1,visible:n.props.visible},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"setInputRef",value:function(e){this.input=e}},{key:"loadHlsMetadata",value:function(){var e=Object(d.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:n=e.sent,this.setState({metadata:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadDashMetadata",value:function(){var e=Object(d.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:n=e.sent,this.setState({metadata:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadMp4Metadata",value:function(){var e=Object(d.a)(f.a.mark(function e(t){var n,a,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:n=e.sent,a=n.videoTracks[0],i={variants:[{bitrate:a.bitrate,width:a.video.width,height:a.video.height}]},this.setState({metadata:i});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.changeSource(this.state.source),console.log("Source selector add event listeners"),this.input.addEventListener("keydown",this.urlInputKeyDown),this.input.addEventListener("keypress",this.stopPropagation),this.input.addEventListener("keyup",this.stopPropagation)}},{key:"componentWillUnmount",value:function(){this.input.removeEventListener("keydown",this.urlInputKeyDown),this.input.removeEventListener("keypress",this.stopPropagation),this.input.removeEventListener("keyup",this.stopPropagation)}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"urlInputKeyDown",value:function(e){switch(e.stopPropagation(),e.keyCode){case 13:this.onUrlSelected(e.target.value);break;case 27:this.hideUrlInput()}}},{key:"onBlur",value:function(){console.log("onBlur"),this.setState({showUrlInput:!1})}},{key:"handleChange",value:function(e){e.target.files&&this.props.onChange(e.target.files[0])}},{key:"showUrlInput",value:function(){this.setState({showUrlInput:!0})}},{key:"hideUrlInput",value:function(){this.setState({showUrlInput:!1})}},{key:"onUrlSelected",value:function(e){console.log("url: ".concat(e)),this.hideUrlInput();var t="url";T(e)?t="hls":j(e)&&(t="dash"),this.changeSource({type:t,name:e,url:e,variant:0})}},{key:"onFileSelected",value:function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];this.changeSource({type:"file",name:t.name,url:window.URL.createObjectURL(t)})}}},{key:"onVariantSelected",value:function(e){console.log("variant selected: ".concat(e.target.value));var t=parseInt(e.target.value);this.setVariant(t)}},{key:"setVariant",value:function(e){var t=Object.assign({},this.state.source,{variant:e});this.setState({source:t}),this.props.onVariantChange&&this.props.onVariantChange(e)}},{key:"loadMetadata",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("hls"!==t.type){e.next=5;break}return e.next=3,this.loadHlsMetadata(t.url);case 3:e.next=12;break;case 5:if("dash"!==t.type){e.next=10;break}return e.next=8,this.loadDashMetadata(t.url);case 8:e.next=12;break;case 10:return e.next=12,this.loadMp4Metadata(t.url);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"changeSource",value:function(e){var t=this;console.log("SourceSelector.changeSource: ".concat(JSON.stringify(e)));var n=this.state.source;this.loadMetadata(e).then(function(){t.setState({source:e}),t.props.onChange(Object.assign({},e)),"file"===n.type&&n.url&&window.URL.revokeObjectURL(n)})}},{key:"componentDidUpdate",value:function(e,t,n){this.state.showUrlInput&&this.input.focus()}},{key:"currentUrl",value:function(){return"file"===this.state.source.type?"":this.state.source.url}},{key:"formatMetadata",value:function(e,t,n){return"[".concat(Math.round(e/1e3),"kbit/s ").concat(t,"x").concat(n,"]")}},{key:"renderSelectedSource",value:function(){var e=this;if(this.state.showUrlInput)return null;var t=this.state.metadata,n=null;if(t)if(t.variants.length>1){var a=t.variants.map(function(t,n){return i.a.createElement("option",{key:n,value:n,selected:n===e.state.source.variant},e.formatMetadata(t.bandwidth,t.width,t.height))});n=i.a.createElement("select",{value:this.state.selectedVariant,onChange:function(t){return e.onVariantSelected(t)}},a)}else if(1===t.variants.length){var r=t.variants[0];n=i.a.createElement("span",null,this.formatMetadata(r.bitrate,r.width,r.height))}return i.a.createElement("div",{className:"source-metadata"},i.a.createElement("div",{className:"source-name",title:this.state.source.name},this.state.source.name),i.a.createElement("div",null,n))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:E()("source-selector",this.props.className,{hidden:!this.props.visible})},i.a.createElement("div",{className:"source-buttons"},i.a.createElement("div",{title:"open URL",className:"url-button"},i.a.createElement(k.b,{style:{cursor:"pointer"},onClick:function(){return e.showUrlInput()}})),i.a.createElement("label",{title:"open local file",className:"source-file-input",onClick:function(t){e.hideUrlInput(),t.stopPropagation()}},i.a.createElement(k.a,null),i.a.createElement("input",{type:"file",onChange:function(t){return e.onFileSelected(t)}}))),i.a.createElement("input",{className:E()("url-input",{hidden:!this.state.showUrlInput}),type:"text",ref:function(t){return e.setInputRef(t)},onBlur:function(){return e.onBlur()},defaultValue:this.currentUrl()}),this.renderSelectedSource())}}]),t}(a.Component),M=(n(286),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).mouseMove=n.mouseMove.bind(Object(g.a)(n)),n.mouseDown=n.mouseDown.bind(Object(g.a)(n)),n.mouseUp=n.mouseUp.bind(Object(g.a)(n)),console.log("Split view constructor"),n.state={splitPercent:0,dragStart:null,dragging:!1},n.setSplitViewContainerRef=function(e){n.splitViewContainer=e},n.setSplitViewClipperRef=function(e){n.splitViewClipper=e},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.splitViewContainer.addEventListener("mousemove",this.mouseMove,{passive:!0}),this.splitViewContainer.addEventListener("mousedown",this.mouseDown),document.addEventListener("mouseup",this.mouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.mouseUp),this.splitViewContainer.removeEventListener("mousedown",this.mouseDown),this.splitViewContainer.removeEventListener("mousemove",this.mouseMove,{passive:!0})}},{key:"mouseUp",value:function(e){this.state.dragging&&(this.ignoreNextClick=!0),this.setState({dragStart:null,dragging:!1})}},{key:"onClick",value:function(e){this.ignoreNextClick?this.ignoreNextClick=!1:this.props.onClick(e)}},{key:"mouseDown",value:function(e){this.setState({dragStart:{x:e.clientX,y:e.clientY}})}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentDidUpdate",value:function(e,t){this.props.tracking&&!e.tracking&&this.setSplitPosition(this.state.splitPercent)}},{key:"mouseMove",value:function(e){this.state.dragStart?(this.setState({dragging:!0}),this.props.onDrag(e.movementX,e.movementY)):this.trackLocation(e)}},{key:"trackLocation",value:function(e){if(this.splitViewContainer){var t=this.splitViewContainer.getBoundingClientRect(),n=(e.pageX-t.left)/this.splitViewContainer.offsetWidth*100;n<=100&&(this.setState({splitPercent:n}),this.props.tracking&&this.setSplitPosition(n))}}},{key:"setSplitPosition",value:function(e){this.splitViewClipper.style.width=e+"%"}},{key:"focus",value:function(){this.splitViewContainer.focus()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:E()("split-view-container",{dragging:this.state.dragging}),ref:function(t){return e.setSplitViewContainerRef(t)},tabIndex:"-1",onClick:function(t){return e.onClick(t)}},i.a.createElement("div",{className:E()("split-view-clipper",{"show-border":this.props.splitBorderVisible}),ref:function(t){return e.setSplitViewClipperRef(t)}},this.props.leftSideContent),this.props.children)}}]),t}(a.Component));function D(e){return e<10?"0"+e:""+e}var H=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60),i=Math.floor((e-Math.floor(e))/.04);return D(t)+":"+D(n)+":"+D(a)+"."+D(i)},z=function(e){var t=e.position;return i.a.createElement("div",{className:"time-display"},H(t))};var B=function(e){var t=e.offset;return 0===t?null:i.a.createElement("div",{className:"offset-indicator"},"offset: ",function(e){return e>0?"+":""}(t),.04*t)},G=(n(287),function(e,t,n){return{name:e,keys:t,description:n}}),W={PLAY:G("PLAY","l","Play video"),PAUSE:G("PAUSE","k","Pause video"),PLAY_PAUSE:G("PLAY_PAUSE","space","Play/Pause video"),STEP_FORWARD_FRAME:G("STEP_FORWARD_FRAME",".","Step forward 1 frame"),STEP_BACKWARD_FRAME:G("STEP_BACKWARD_FRAME",",","Step backward 1 frame"),STEP_FORWARD:G("STEP_FORWARD",["/","-"],"Step forward 1 second"),STEP_BACKWARD:G("STEP_BACKWARD","m","Step backward 1 second"),FULLSCREEN:G("FULLSCREEN","f","Toggle full screen"),SHARE:G("SHARE","c","Copy shareable url to clipboard"),TOGGLE_TRACKING:G("TOGGLE_TRACKING","t","Toggle split position follows mouse"),LEFT_ONLY:G("LEFT_ONLY","]","View only left video"),RIGHT_ONLY:G("RIGHT_ONLY","[","View only right video"),TIMESHIFT_DECREASE:G("OFFSET_DECREASE","<","Decrease timeshift between videos"),TIMESHIFT_INCREASE:G("OFFSET_INCREASE",">","Increase timeshift between videos"),TIMESHIFT_RESET:G("OFFSET_RESET","r","Reset timeshift between videos"),ZOOM_IN:G("ZOOM_IN","u","Zoom in"),ZOOM_OUT:G("ZOOM_OUT","i","Zoom out"),PAN_UP:G("PAN_UP","up","Pan up"),PAN_DOWN:G("PAN_DOWN","down","Pan down"),PAN_RIGHT:G("PAN_RIGHT","right","Pan right"),PAN_LEFT:G("PAN_LEFT","left","Pan left"),REST_PAN_ZOOM:G("RESET_PAN_ZOOM","0","Reset pan and zoom to default"),TOGGLE_HELP:G("TOOGLE_HELP","esc","Toggle help window"),TOGGLE_SPLIT_BORDER_VISIBLE:G("TOGGLE_SPLIT_BORDER_VISIBLE","s","Toggle split border visible")},Z=Object.keys(W).reduce(function(e,t){return Object.assign(e,Object(m.a)({},W[t].name,W[t].keys))},{});console.log("KEY_MAP: ".concat(JSON.stringify(Z)));var K=function(e){var t=e.visible,n=e.onClick;return i.a.createElement("div",{className:E()("help",{hidden:!t})},i.a.createElement("div",{className:"help-header"},i.a.createElement("h3",{className:"padding10"},"Vivict - Vivict Video Comparison Tool"),i.a.createElement("div",{className:"close-button",onClick:function(){return n()}},i.a.createElement(k.i,null))),i.a.createElement("div",null,i.a.createElement("h4",{className:"padding10"},"Keybindings:"),q(),J(),X()))},Y=function(e){var t=e.onClick,n=e.className;return i.a.createElement("div",{className:"help-button "+n,onClick:function(e){return t(e)}},i.a.createElement(k.c,null))},q=function(){return Object.keys(W).map(function(e){var t=W[e];return i.a.createElement("div",{key:"keybinding-"+t.name},i.a.createElement("span",{className:"bold"},t.keys),"  "+t.description)})},J=function(){return i.a.createElement("h4",{className:"padding10"},"Copyright 2019 Sveriges Television AB.")},X=function(){return i.a.createElement("a",{href:"https://github.com/SVT/vivict"},"Contribute on Github, released under MIT")};function Q(e){var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)}function $(e){return T(e)?"hls":j(e)?"dash":"url"}function ee(e){return"hls"===e||"dash"===e}var te=new URLSearchParams(window.location.search),ne={hls:"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",dash:"https://dash.akamaized.net/dash264/TestCases/2a/qualcomm/1/MultiResMPEG2.mpd",av1:"https://storage.googleapis.com/bitmovin-demos/av1/stream.mpd"}[te.get("defaultSource")?te.get("defaultSource"):"hls"],ae=te.get("leftVideoUrl")||ne,ie=te.get("rightVideoUrl")||ae,re=Number(te.get("leftVideoVariant"))||0,oe=Number(te.get("rightVideoVariant"))||0,se=Number(te.get("position"))||0,ue=Boolean(te.get("hideSourceSelector")),ce=Boolean(te.get("hideHelp")),le={type:$(ae),name:ae,url:ae,variant:re,position:se},he={type:$(ae),name:ie,url:ie,variant:oe,position:se},pe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).shortCutHandlers=[[W.STEP_FORWARD,function(){return n.step(25)}],[W.STEP_FORWARD_FRAME,function(){return n.step(1)}],[W.STEP_BACKWARD_FRAME,function(){return n.step(-1)}],[W.STEP_BACKWARD,function(){return n.step(-25)}],[W.PLAY_PAUSE,function(){return n.playPause()}],[W.FULLSCREEN,function(){return n.fullscreen()}],[W.TOGGLE_TRACKING,function(){return n.toggleTracking()}],[W.LEFT_ONLY,function(){return n.splitView.setSplitPosition(100)}],[W.RIGHT_ONLY,function(){return n.splitView.setSplitPosition(0)}],[W.TIMESHIFT_INCREASE,function(){return n.changeOffset(1)}],[W.TIMESHIFT_DECREASE,function(){return n.changeOffset(-1)}],[W.TIMESHIFT_RESET,function(){return n.changeOffset(0)}],[W.ZOOM_IN,function(){return n.zoomIn()}],[W.ZOOM_OUT,function(){return n.zoomOut()}],[W.PAN_UP,function(){return n.pan(0,10)}],[W.PAN_DOWN,function(){return n.pan(0,-10)}],[W.PAN_RIGHT,function(){return n.pan(-10,0)}],[W.PAN_LEFT,function(){return n.pan(10,0)}],[W.REST_PAN_ZOOM,function(){return n.resetPanZoom()}],[W.SHARE,function(){return n.createShareUrl()}],[W.PLAY,function(){return n.playForward()}],[W.PAUSE,function(){return n.pause()}],[W.TOGGLE_HELP,function(){return n.toggleShowHelp()}],[W.TOGGLE_SPLIT_BORDER_VISIBLE,function(){return n.toggleSplitBorderVisible()}]].reduce(function(e,t){var n=Object(v.a)(t,2),a=n[0],i=n[1];return Object.assign(e,Object(m.a)({},a.name,i))},{}),n.setVideoViewerRef=function(e){n.videoViewer=e},n.setRightVideoRef=function(e){console.log("setRightVideoRef",e),n.rightVideo=e},n.setLeftVideoRef=function(e){n.leftVideo=e},n.setSplitViewRef=function(e){n.splitView=e},n.state={playing:!1,duration:0,position:0,leftSource:{name:"NONE",url:null,variant:re},rightSource:{name:"NONE",url:null,variant:oe},tracking:!0,splitBorderVisible:!0,rightVideoOffset:0,showHelp:!ce,showSourceSelector:!ue,playReverse:!1,userDefinedPanZoom:!1},console.dir(n.state),n.onFullScreenChange=n.onFullScreenChange.bind(Object(g.a)(n)),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"setPosition",value:function(e){this.setState({position:e})}},{key:"setPlaying",value:function(e){this.setState({playing:e})}},{key:"setLeftSource",value:function(e){this.setState({leftSource:e})}},{key:"setRightSource",value:function(e){this.setState({rightSource:e})}},{key:"toggleTracking",value:function(){this.setState({tracking:!this.state.tracking})}},{key:"changeOffset",value:function(e){var t=this;0===e?this.setState({rightVideoOffset:e}):this.setState({rightVideoOffset:this.state.rightVideoOffset+e}),this.state.playing?this.pause().then(function(){return t.play()}):this.seek(this.leftVideo.currentTime())}},{key:"playPause",value:function(){this.state.playing?this.pause():this.play()}},{key:"step",value:function(){var e=Object(d.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.rightVideo.currentTime()+.04*t,this.rightVideo.quickSeek(n),this.leftVideo.quickSeek(n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fullscreen",value:function(){var e;document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():(e=this.videoViewer).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"onTimeUpdate",value:function(e){this.setPosition(e)}},{key:"onDurationSet",value:function(e){this.setState({duration:e})}},{key:"syncPlayers",value:function(){this.leftVideo.seek(this.rightVideo.currentTime()),this.setPosition(this.leftVideo.currentTime())}},{key:"playForward",value:function(){var e=Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.playing){e.next=3;break}return e.next=3,this.pause();case 3:return this.leftVideo.playbackRate=1,this.rightVideo.playbackRate=1,e.abrupt("return",this.play());case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.playing){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,Promise.all([this.rightVideo.play(),this.leftVideo.play()]);case 4:this.setPlaying(!0);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createShareUrl",value:function(){var e=Object(d.a)(f.a.mark(function e(){var t,n,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"file"===this.state.leftSource.type||"file"===this.state.rightSource.type?alert("Shareable URL cannot be created since you are viewing a local file!"):(t=ee(this.state.leftSource.type)?"&leftVideoVariant=".concat(this.state.leftSource.variant):"",n=ee(this.state.rightSource.type)?"&rightVideoVariant=".concat(this.state.rightSource.variant):"",a="".concat(window.location.host).concat(window.location.pathname,"?position=").concat(this.state.position)+"&leftVideoUrl=".concat(this.state.leftSource.url).concat(t)+"&rightVideoUrl=".concat(this.state.rightSource.url).concat(n)+(te.get("hideSourceSelector")?"&hideSourceSelector=".concat(te.get("hideSourceSelector")):"")+(te.get("hideHelp")?"&hideHelp=".concat(te.get("hideHelp")):""),console.log("Copying to clipboard: "+a),Q(a));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.playing){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return this.rightVideo.pause(),this.leftVideo.pause(),this.setPlaying(!1),e.abrupt("return",this.seek(this.leftVideo.currentTime()));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"seek",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({position:t}),e.abrupt("return",Promise.all([this.leftVideo.seek(t),this.rightVideo.seek(t+.04*this.state.rightVideoOffset)]));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onLeftVariantChange",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("left variant changed: ".concat(JSON.stringify(t))),e.next=3,this.changeVariant(this.leftVideo,t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onRightVariantChange",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("right variant changed: ".concat(JSON.stringify(t))),e.next=3,this.changeVariant(this.rightVideo,t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onLeftSourceChange",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changeSource(this.leftVideo,t);case 2:this.setLeftSource(t),this.splitView.focus();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onRightSourceChange",value:function(){var e=Object(d.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changeSource(this.rightVideo,t);case 2:this.setRightSource(t),this.splitView.focus();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"changeVariant",value:function(){var e=Object(d.a)(f.a.mark(function e(t,n){var a=this;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.pauseAndExecute(t,Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({leftSource:Object.assign({},a.state.leftSource,{variant:n})}),e.next=3,t.setVariant(n);case 3:return e.next=5,a.step(0);case 5:case"end":return e.stop()}},e)})));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"changeSource",value:function(){var e=Object(d.a)(f.a.mark(function e(t,n){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Change source ".concat(n.url," ").concat(n.variant)),this.pauseAndExecute(t,Object(d.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadSource(n.url,n.variant);case 2:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"pauseAndExecute",value:function(){var e=Object(d.a)(f.a.mark(function e(t,n){var a,i,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.playing,i=this.state.playReverse,e.next=4,this.pause();case 4:return r=t.currentTime(),console.log("".concat(JSON.stringify(t.props)," time: ").concat(r)),e.next=8,n();case 8:return e.next=10,this.seek(r);case 10:if(!a){e.next=13;break}return e.next=13,this.play();case 13:if(!i){e.next=16;break}return e.next=16,this.playReverse();case 16:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"zoomIn",value:function(){this.leftVideo.zoomIn(),this.rightVideo.zoomIn(),this.setState({userDefinedPanZoom:!0})}},{key:"zoomOut",value:function(){this.leftVideo.zoomOut(),this.rightVideo.zoomOut(),this.setState({userDefinedPanZoom:!0})}},{key:"resetPanZoom",value:function(){this.leftVideo.resetPanZoom(),this.rightVideo.resetPanZoom(),this.setState({userDefinedPanZoom:!1})}},{key:"pan",value:function(e,t){this.leftVideo.pan(e,t),this.rightVideo.pan(e,t),this.setState({userDefinedPanZoom:!0})}},{key:"toggleShowHelp",value:function(){this.setState({showHelp:!this.state.showHelp})}},{key:"toggleSplitBorderVisible",value:function(){this.setState({splitBorderVisible:!this.state.splitBorderVisible})}},{key:"onFullScreenChange",value:function(){this.state.userDefinedPanZoom||this.resetPanZoom()}},{key:"componentDidMount",value:function(){this.splitView.focus(),this.seek(se).catch(function(e){return console.trace(e)}),this.videoViewer.addEventListener("fullscreenchange",this.onFullScreenChange)}},{key:"componentWillUnmount",value:function(){this.videoViewer.removeEventListener("fullscreenchange",this.onFullScreenChange)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"video-viewer",tabIndex:"0",ref:this.setVideoViewerRef},i.a.createElement(z,{position:this.state.position}),i.a.createElement(y.HotKeys,{className:"hotkeys-div",keyMap:Z,handlers:this.shortCutHandlers},i.a.createElement(M,{tracking:this.state.tracking,splitBorderVisible:this.state.splitBorderVisible,onDrag:function(t,n){return e.pan(t,n)},onClick:function(){return e.playPause()},ref:this.setSplitViewRef,leftSideContent:i.a.createElement(U,{muted:!0,ref:this.setLeftVideoRef})},i.a.createElement(U,{ref:this.setRightVideoRef,onTimeUpdate:function(t){return e.onTimeUpdate(t)},onDurationSet:function(t){return e.onDurationSet(t)}}),i.a.createElement("div",{className:E()("big-play-button",{hidden:this.state.playing||0!==this.state.position}),onClick:function(){return e.play()}},i.a.createElement(k.f,{size:"32px"}))),i.a.createElement(b,{visible:this.state.showSourceSelector,playing:this.state.playing,onPlay:function(){return e.playPause()},onStep:function(t){return e.step(t)},onFullscreen:function(){return e.fullscreen()},duration:this.state.duration,onSeek:function(t){return e.seek(t)},position:this.state.position}),i.a.createElement(F,{visible:this.state.showSourceSelector,className:"left-source-selector",defaultSource:le,onChange:function(t){return e.onLeftSourceChange(t)},onVariantChange:function(t){return e.onLeftVariantChange(t)}}),i.a.createElement(F,{visible:this.state.showSourceSelector,className:"right-source-selector",defaultSource:he,onChange:function(t){return e.onRightSourceChange(t)},onVariantChange:function(t){return e.onRightVariantChange(t)}}),i.a.createElement(B,{offset:this.state.rightVideoOffset}),i.a.createElement(K,{visible:this.state.showHelp,onClick:function(){return e.toggleShowHelp()}}),i.a.createElement(Y,{onClick:function(){return e.toggleShowHelp()}})))}}]),t}(a.Component),fe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(pe,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[114,1,2]]]);
//# sourceMappingURL=main.9df74ab6.chunk.js.map