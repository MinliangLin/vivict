(this.webpackJsonpvivict=this.webpackJsonpvivict||[]).push([[0],{123:function(e,t,n){},125:function(e,t,n){},147:function(e,t){},149:function(e,t){},290:function(e,t,n){},291:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},294:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(52),o=n.n(r),s=(n(123),n(16)),u=n(17),c=n(19),l=n(18),h=(n(124),n(125),n(2)),p=n.n(h),f=n(7),d=n(54),m=n(12),v=n(108),g=n(15),y=n.n(g),k=n(13),S=function(e){var t=e.onPlay,n=e.onStep,a=e.onFullscreen,r=e.playing,o=e.onSeek,s=e.position,u=e.duration;return i.a.createElement("div",{className:"controls"},i.a.createElement("button",{className:"btn btn-default",onClick:function(e){n(-1),e.stopPropagation()}},i.a.createElement(k.g,null)),i.a.createElement("button",{className:y()("btn","btn-default"),onClick:function(e){console.log("play/pause: "),t(),e.stopPropagation()}},r?i.a.createElement(k.e,null):i.a.createElement(k.f,null)),i.a.createElement("button",{className:"btn btn-default",onClick:function(e){n(1),e.stopPropagation()}},i.a.createElement(k.h,null)),i.a.createElement("input",{type:"range",value:s,min:"0",max:u,step:"0.04",onInput:function(e){console.log("range value: ".concat(e.target.value));var t=parseFloat(e.target.value);o(t),e.stopPropagation()}}),i.a.createElement("button",{className:"btn btn-default glyphicon glyphicon-fullscreen",onClick:function(e){a(),e.stopPropagation()}},i.a.createElement(k.d,null)))},E=n(111),b=n.n(E),w=n(112),O=n.n(w),V=n(55),P=n(113);function R(e){return!!e&&e.split("?")[0].endsWith(".m3u8")}function C(e){return T.apply(this,arguments)}function T(){return(T=Object(f.a)(p.a.mark((function e(t){var n,a,i,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,(i=new P.a).push(a),i.end(),r=i.manifest,o=r.playlists.map((function(e){return Object(V.a)({url:x(t,e.uri),bandwidth:e.attributes.BANDWIDTH},e.attributes.RESOLUTION)})),e.abrupt("return",{mainUrl:t,variants:o,selectedVariant:0});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return 0===(n=t).indexOf("http://")||0===n.indexOf("https://")?t:e.replace(/\/[^/]*$/,"/"+t);var n}var L=n(118);function N(e){return I.apply(this,arguments)}function I(){return(I=Object(f.a)(p.a.mark((function e(t){var n,a,i,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,console.log("RAW DASH MANIFEST:"+a),i=Object(L.a)(a),console.log("DASH MANIFEST:\n"+JSON.stringify(i)),r=i.playlists.map((function(e,t){return Object(V.a)({url:null,index:t,bandwidth:e.attributes.BANDWIDTH},e.attributes.RESOLUTION)})),e.abrupt("return",{mainUrl:t,variants:r,selectedVariant:0});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return!!e&&e.split("?")[0].endsWith(".mpd")}var _=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={zoom:1,panHorizontal:0,panVertical:0},a.onTimeUpdate=a.onTimeUpdate.bind(Object(m.a)(a)),a.onMetadataLoaded=a.onMetadataLoaded.bind(Object(m.a)(a)),a.setVideoRef=function(e){a.videoElement=e},a}return Object(u.a)(n,[{key:"onTimeUpdate",value:function(){this.props.onTimeUpdate&&this.props.onTimeUpdate(this.videoElement.currentTime)}},{key:"onMetadataLoaded",value:function(){this.props.onDurationSet&&this.props.onDurationSet(this.videoElement.duration)}},{key:"play",value:function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.videoElement.play());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){this.videoElement.pause()}},{key:"quickSeek",value:function(e){this.videoElement.currentTime=e}},{key:"zoomIn",value:function(){this.zoom(1.1)}},{key:"zoomOut",value:function(){this.zoom(.9090909090909091)}},{key:"zoom",value:function(e){var t=(1-e)/2*document.documentElement.clientWidth+e*this.state.panHorizontal,n=(1-e)/2*document.documentElement.clientHeight+e*this.state.panVertical;this.setState({zoom:this.state.zoom*e,panHorizontal:t,panVertical:n})}},{key:"pan",value:function(e,t){this.setState({panHorizontal:this.state.panHorizontal+e,panVertical:this.state.panVertical+t})}},{key:"resetPanZoom",value:function(){var e=(document.documentElement.clientHeight-this.videoElement.offsetHeight/this.state.zoom)/2;this.setState({zoom:1,panHorizontal:0,panVertical:e})}},{key:"seek",value:function(){var e=Object(f.a)(p.a.mark((function e(t){var n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>this.videoElement.duration)){e.next=2;break}return e.abrupt("return",Promise.reject("Invalid seek position: ".concat(t,", media duration is ").concat(this.videoElement.duration)));case 2:return e.abrupt("return",new Promise((function(e,a){n.videoElement.addEventListener("seeked",(function(){e()}),{once:!0}),n.videoElement.currentTime=t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSource",value:function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("load source: ".concat(t," ").concat(n)),e.abrupt("return",new Promise((function(e,i){a.videoElement.addEventListener("canplay",(function(){e()}),{once:!0}),R(t)?a.loadHls(t,n):A(t)?a.loadDash(t,n):a.videoElement.src=t})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setVariant",value:function(e){console.log("setVariant: ".concat(e)),this.state.dash?this.state.dash.setQualityFor("video",e):this.state.hls&&(this.state.hls.currentLevel=e)}},{key:"loadDash",value:function(e,t){var n=this;this.state.hls&&(this.state.hls.detachMedia(),this.setState({hls:null}));var a=this.state.dash;this.videoElement.addEventListener("canplay",(function(){n.state.dash.setQualityFor("video",t)}),{once:!0}),a?a.attachSource(e):(a=O.a.MediaPlayer().create(),this.setState({dash:a}),a.updateSettings({streaming:{fastSwitchEnabled:!0,abr:{autoSwitchBitrate:{audio:!1,video:!1}}}}),a.initialize(this.videoElement,e,!1))}},{key:"loadHls",value:function(e,t){this.setState({dash:null});var n=this.state.hls;n||(n=new b.a,this.setState({hls:n})),n.loadSource(e),n.attachMedia(this.videoElement),n.currentLevel=t}},{key:"currentTime",value:function(){return this.videoElement.currentTime}},{key:"componentDidMount",value:function(){this.videoElement.addEventListener("timeupdate",this.onTimeUpdate),this.videoElement.addEventListener("loadedmetadata",this.onMetadataLoaded)}},{key:"componentWillUnmount",value:function(){this.videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this.videoElement.removeEventListener("loadedmetadata",this.onMetadataLoaded)}},{key:"render",value:function(){var e=parseInt(100*this.state.zoom)+"vw";return i.a.createElement("video",{muted:this.props.muted,ref:this.setVideoRef,tabIndex:"-1",style:{width:e,left:this.state.panHorizontal+"px",top:this.state.panVertical+"px"}})}}]),n}(a.Component),U=(n(290),n(291),n(117)),F=n.n(U);function j(e,t,n){return M.apply(this,arguments)}function M(){return(M=Object(f.a)(p.a.mark((function e(t,n,a){var i,r,o,s,u,c,l,h,f=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=f.length>3&&void 0!==f[3]?f[3]:10485760,!t.startsWith("blob:")){e.next=11;break}return e.next=4,fetch(t);case 4:return r=e.sent,e.next=7,r.arrayBuffer();case 7:return(o=e.sent).fileStart=0,n(o),e.abrupt("return");case 11:s=0,u=i;case 13:if(a()){e.next=29;break}return e.next=16,D(t,{start:s,end:u});case 16:if(c=e.sent,l=c.data,h=parseInt(c.contentRange.split("/")[1]),l.fileStart=s,n(l),u!==h){e.next=23;break}return e.abrupt("break",29);case 23:if(s=u,u=Math.min(h,s+i),!(l.length<i)){e.next=27;break}return e.abrupt("break",29);case 27:e.next=13;break;case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return H.apply(this,arguments)}function H(){return(H=Object(f.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"GET",headers:{Range:"bytes=".concat(n.start,"-").concat(n.end)}});case 2:if((a=e.sent).ok){e.next=5;break}throw Error("Fetch failed with status: ".concat(a.status));case 5:return e.next=7,a.arrayBuffer();case 7:return e.t0=e.sent,e.t1=a.headers.get("Content-Length"),e.t2=a.headers.get("Content-Range"),e.abrupt("return",{data:e.t0,contentLength:e.t1,contentRange:e.t2});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return z.apply(this,arguments)}function z(){return(z=Object(f.a)(p.a.mark((function e(t){var n,a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("mp4Info: ".concat(t)),n=!1,a=new F.a.createFile,i=new Promise((function(e,i){a.onError=function(e){n=!0,console.log(e),i(e)},a.onReady=function(t){n=!0,e(t)},j(t,(function(e){a.appendBuffer(e)}),(function(){return n})).catch((function(e){i(e)}))})),e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).stopPropagation=a.stopPropagation.bind(Object(m.a)(a)),a.urlInputKeyDown=a.urlInputKeyDown.bind(Object(m.a)(a)),a.state={source:a.props.defaultSource,metadata:null,showUrlInput:!1,visible:a.props.visible},a}return Object(u.a)(n,[{key:"setInputRef",value:function(e){this.input=e}},{key:"loadHlsMetadata",value:function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:n=e.sent,this.setState({metadata:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadDashMetadata",value:function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:n=e.sent,this.setState({metadata:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadMp4Metadata",value:function(){var e=Object(f.a)(p.a.mark((function e(t){var n,a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(t);case 3:n=e.sent,a=n.videoTracks[0],i={variants:[{bitrate:a.bitrate,width:a.video.width,height:a.video.height}]},this.setState({metadata:i}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Failed to get mp4 info: ".concat(e.t0));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.changeSource(this.state.source),console.log("Source selector add event listeners"),this.input.addEventListener("keydown",this.urlInputKeyDown),this.input.addEventListener("keypress",this.stopPropagation),this.input.addEventListener("keyup",this.stopPropagation)}},{key:"componentWillUnmount",value:function(){this.input.removeEventListener("keydown",this.urlInputKeyDown),this.input.removeEventListener("keypress",this.stopPropagation),this.input.removeEventListener("keyup",this.stopPropagation)}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"urlInputKeyDown",value:function(e){switch(e.stopPropagation(),e.keyCode){case 13:this.onUrlSelected(e.target.value);break;case 27:this.hideUrlInput()}}},{key:"onBlur",value:function(){console.log("onBlur"),this.setState({showUrlInput:!1})}},{key:"handleChange",value:function(e){e.target.files&&this.props.onChange(e.target.files[0])}},{key:"showUrlInput",value:function(){this.setState({showUrlInput:!0})}},{key:"hideUrlInput",value:function(){this.setState({showUrlInput:!1})}},{key:"onUrlSelected",value:function(e){console.log("url: ".concat(e)),this.hideUrlInput();var t="url";R(e)?t="hls":A(e)&&(t="dash"),this.changeSource({type:t,name:e,url:e,variant:0})}},{key:"onFileSelected",value:function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];this.changeSource({type:"file",name:t.name,url:window.URL.createObjectURL(t)})}}},{key:"onVariantSelected",value:function(e){var t=parseInt(e.target.value);this.setVariant(t)}},{key:"setVariant",value:function(e){var t=Object.assign({},this.state.source,{variant:e});this.setState({source:t}),this.props.onVariantChange&&this.props.onVariantChange(e)}},{key:"loadMetadata",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("hls"!==t.type){e.next=5;break}return e.next=3,this.loadHlsMetadata(t.url);case 3:e.next=12;break;case 5:if("dash"!==t.type){e.next=10;break}return e.next=8,this.loadDashMetadata(t.url);case 8:e.next=12;break;case 10:return e.next=12,this.loadMp4Metadata(t.url);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeSource",value:function(e){var t=this,n=this.state.source;this.loadMetadata(e).then((function(){t.setState({source:e}),t.props.onChange(Object.assign({},e)),"file"===n.type&&n.url&&window.URL.revokeObjectURL(n.url)}))}},{key:"componentDidUpdate",value:function(e,t,n){this.state.showUrlInput&&this.input.focus()}},{key:"currentUrl",value:function(){return"file"===this.state.source.type?"":this.state.source.url}},{key:"formatMetadata",value:function(e,t,n){return"[".concat(Math.round(e/1e3),"kbit/s ").concat(t,"x").concat(n,"]")}},{key:"renderSelectedSource",value:function(){var e=this;if(this.state.showUrlInput)return null;var t=this.state.metadata,n=null;if(t)if(t.variants.length>1){var a=t.variants.map((function(t,n){return i.a.createElement("option",{key:n,value:n,selected:n===e.state.source.variant},e.formatMetadata(t.bandwidth,t.width,t.height))}));n=i.a.createElement("select",{value:this.state.selectedVariant,onChange:function(t){return e.onVariantSelected(t)}},a)}else if(1===t.variants.length){var r=t.variants[0];n=i.a.createElement("span",null,this.formatMetadata(r.bitrate,r.width,r.height))}return i.a.createElement("div",{className:"source-metadata"},i.a.createElement("div",{className:"source-name",title:this.state.source.name},this.state.source.name),i.a.createElement("div",null,n))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:y()("source-selector",this.props.className,{hidden:!this.props.visible})},i.a.createElement("div",{className:"source-buttons"},i.a.createElement("div",{title:"open URL",className:"url-button"},i.a.createElement(k.b,{style:{cursor:"pointer"},onClick:function(){return e.showUrlInput()}})),i.a.createElement("label",{title:"open local file",className:"source-file-input",onClick:function(t){e.hideUrlInput(),t.stopPropagation()}},i.a.createElement(k.a,null),i.a.createElement("input",{type:"file",onChange:function(t){return e.onFileSelected(t)}}))),i.a.createElement("input",{className:y()("url-input",{hidden:!this.state.showUrlInput}),type:"text",ref:function(t){return e.setInputRef(t)},onBlur:function(){return e.onBlur()},defaultValue:this.currentUrl()}),this.renderSelectedSource())}}]),n}(a.Component),W=(n(292),function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).mouseMove=a.mouseMove.bind(Object(m.a)(a)),a.mouseDown=a.mouseDown.bind(Object(m.a)(a)),a.mouseUp=a.mouseUp.bind(Object(m.a)(a)),console.log("Split view constructor"),a.state={splitPercent:0,dragStart:null,dragging:!1},a.setSplitViewContainerRef=function(e){a.splitViewContainer=e},a.setSplitViewClipperRef=function(e){a.splitViewClipper=e},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.splitViewContainer.addEventListener("mousemove",this.mouseMove,{passive:!0}),this.splitViewContainer.addEventListener("mousedown",this.mouseDown),document.addEventListener("mouseup",this.mouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.mouseUp),this.splitViewContainer.removeEventListener("mousedown",this.mouseDown),this.splitViewContainer.removeEventListener("mousemove",this.mouseMove,{passive:!0})}},{key:"mouseUp",value:function(e){this.state.dragging&&(this.ignoreNextClick=!0),this.setState({dragStart:null,dragging:!1})}},{key:"onClick",value:function(e){this.ignoreNextClick?this.ignoreNextClick=!1:this.props.onClick(e)}},{key:"mouseDown",value:function(e){this.setState({dragStart:{x:e.clientX,y:e.clientY}})}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentDidUpdate",value:function(e,t){this.props.tracking&&!e.tracking&&this.setSplitPosition(this.state.splitPercent)}},{key:"mouseMove",value:function(e){this.state.dragStart?(this.setState({dragging:!0}),this.props.onDrag(e.movementX,e.movementY)):this.trackLocation(e)}},{key:"trackLocation",value:function(e){if(this.splitViewContainer){var t=this.splitViewContainer.getBoundingClientRect(),n=(e.pageX-t.left)/this.splitViewContainer.offsetWidth*100;n<=100&&(this.setState({splitPercent:n}),this.props.tracking&&this.setSplitPosition(n))}}},{key:"setSplitPosition",value:function(e){this.splitViewClipper.style.width=e+"%"}},{key:"focus",value:function(){this.splitViewContainer.focus()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:y()("split-view-container",{dragging:this.state.dragging}),ref:function(t){return e.setSplitViewContainerRef(t)},tabIndex:"-1",onClick:function(t){return e.onClick(t)}},i.a.createElement("div",{className:y()("split-view-clipper",{"show-border":this.props.splitBorderVisible}),ref:function(t){return e.setSplitViewClipperRef(t)}},this.props.leftSideContent),this.props.children)}}]),n}(a.Component));function Z(e){return e<10?"0"+e:""+e}var K=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60),i=Math.floor((e-Math.floor(e))/.04);return Z(t)+":"+Z(n)+":"+Z(a)+"."+Z(i)},Y=function(e){var t=e.position;return i.a.createElement("div",{className:"time-display"},K(t))};var q=function(e){var t=e.offset;return 0===t?null:i.a.createElement("div",{className:"offset-indicator"},"offset: ",function(e){return e>0?"+":""}(t),.04*t)},J=(n(293),function(e,t,n){return{name:e,keys:t,description:n}}),X={PLAY:J("PLAY","l","Play video"),PAUSE:J("PAUSE","k","Pause video"),PLAY_PAUSE:J("PLAY_PAUSE","space","Play/Pause video"),STEP_FORWARD_FRAME:J("STEP_FORWARD_FRAME",".","Step forward 1 frame"),STEP_BACKWARD_FRAME:J("STEP_BACKWARD_FRAME",",","Step backward 1 frame"),STEP_FORWARD:J("STEP_FORWARD",["/","-"],"Step forward 1 second"),STEP_BACKWARD:J("STEP_BACKWARD","m","Step backward 1 second"),FULLSCREEN:J("FULLSCREEN","f","Toggle full screen"),SHARE:J("SHARE","c","Copy shareable url to clipboard"),TOGGLE_TRACKING:J("TOGGLE_TRACKING","t","Toggle split position follows mouse"),LEFT_ONLY:J("LEFT_ONLY","]","View only left video"),RIGHT_ONLY:J("RIGHT_ONLY","[","View only right video"),TIMESHIFT_DECREASE:J("OFFSET_DECREASE","<","Decrease timeshift between videos"),TIMESHIFT_INCREASE:J("OFFSET_INCREASE",">","Increase timeshift between videos"),TIMESHIFT_RESET:J("OFFSET_RESET","r","Reset timeshift between videos"),ZOOM_IN:J("ZOOM_IN","u","Zoom in"),ZOOM_OUT:J("ZOOM_OUT","i","Zoom out"),PAN_UP:J("PAN_UP","up","Pan up"),PAN_DOWN:J("PAN_DOWN","down","Pan down"),PAN_RIGHT:J("PAN_RIGHT","right","Pan right"),PAN_LEFT:J("PAN_LEFT","left","Pan left"),REST_PAN_ZOOM:J("RESET_PAN_ZOOM","0","Reset pan and zoom to default"),TOGGLE_HELP:J("TOOGLE_HELP","esc","Toggle help window"),TOGGLE_SPLIT_BORDER_VISIBLE:J("TOGGLE_SPLIT_BORDER_VISIBLE","s","Toggle split border visible")},Q=Object.keys(X).reduce((function(e,t){return Object.assign(e,{[X[t].name]:X[t].keys})}),{});console.log("KEY_MAP: ".concat(JSON.stringify(Q)));var $=function(e){var t=e.visible,n=e.onClick;return i.a.createElement("div",{className:y()("help",{hidden:!t})},i.a.createElement("div",{className:"help-header"},i.a.createElement("h3",{className:"padding10"},"Vivict - Vivict Video Comparison Tool"),i.a.createElement("div",{className:"close-button",onClick:function(){return n()}},i.a.createElement(k.i,null))),i.a.createElement("div",null,i.a.createElement("h4",{className:"padding10"},"Keybindings:"),te(),ne(),ae()))},ee=function(e){var t=e.onClick,n=e.className;return i.a.createElement("div",{className:"help-button "+n,onClick:function(e){return t(e)}},i.a.createElement(k.c,null))},te=function(){return Object.keys(X).map((function(e){var t=X[e];return i.a.createElement("div",{key:"keybinding-"+t.name},i.a.createElement("span",{className:"bold"},t.keys),"  "+t.description)}))},ne=function(){return i.a.createElement("h4",{className:"padding10"},"Copyright 2019 Sveriges Television AB.")},ae=function(){return i.a.createElement("a",{href:"https://github.com/SVT/vivict"},"Contribute on Github, released under MIT")};function ie(e){var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)}function re(e){return R(e)?"hls":A(e)?"dash":"url"}function oe(e){return"hls"===e||"dash"===e}var se=new URLSearchParams(window.location.search),ue={hls:"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",dash:"https://dash.akamaized.net/dash264/TestCases/2a/qualcomm/1/MultiResMPEG2.mpd",av1:"https://storage.googleapis.com/bitmovin-demos/av1/stream.mpd"}[se.get("defaultSource")?se.get("defaultSource"):"hls"],ce=se.get("leftVideoUrl")||ue,le=se.get("rightVideoUrl")||ce,he=Number(se.get("leftVideoVariant"))||0,pe=Number(se.get("rightVideoVariant"))||0,fe=Number(se.get("position"))||0,de=Boolean(se.get("hideSourceSelector")),me=Boolean(se.get("hideHelp")),ve={type:re(ce),name:ce,url:ce,variant:he,position:fe},ge={type:re(le),name:le,url:le,variant:pe,position:fe},ye=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).shortCutHandlers=[[X.STEP_FORWARD,function(){return a.step(25)}],[X.STEP_FORWARD_FRAME,function(){return a.step(1)}],[X.STEP_BACKWARD_FRAME,function(){return a.step(-1)}],[X.STEP_BACKWARD,function(){return a.step(-25)}],[X.PLAY_PAUSE,function(){return a.playPause()}],[X.FULLSCREEN,function(){return a.fullscreen()}],[X.TOGGLE_TRACKING,function(){return a.toggleTracking()}],[X.LEFT_ONLY,function(){return a.splitView.setSplitPosition(100)}],[X.RIGHT_ONLY,function(){return a.splitView.setSplitPosition(0)}],[X.TIMESHIFT_INCREASE,function(){return a.changeOffset(1)}],[X.TIMESHIFT_DECREASE,function(){return a.changeOffset(-1)}],[X.TIMESHIFT_RESET,function(){return a.changeOffset(0)}],[X.ZOOM_IN,function(){return a.zoomIn()}],[X.ZOOM_OUT,function(){return a.zoomOut()}],[X.PAN_UP,function(){return a.pan(0,10)}],[X.PAN_DOWN,function(){return a.pan(0,-10)}],[X.PAN_RIGHT,function(){return a.pan(-10,0)}],[X.PAN_LEFT,function(){return a.pan(10,0)}],[X.REST_PAN_ZOOM,function(){return a.resetPanZoom()}],[X.SHARE,function(){return a.createShareUrl()}],[X.PLAY,function(){return a.playForward()}],[X.PAUSE,function(){return a.pause()}],[X.TOGGLE_HELP,function(){return a.toggleShowHelp()}],[X.TOGGLE_SPLIT_BORDER_VISIBLE,function(){return a.toggleSplitBorderVisible()}]].reduce((function(e,t){var n=Object(d.a)(t,2),a=n[0],i=n[1];return Object.assign(e,{[a.name]:i})}),{}),a.setVideoViewerRef=function(e){a.videoViewer=e},a.setRightVideoRef=function(e){console.log("setRightVideoRef",e),a.rightVideo=e},a.setLeftVideoRef=function(e){a.leftVideo=e},a.setSplitViewRef=function(e){a.splitView=e},a.state={playing:!1,duration:0,position:0,leftSource:{name:"NONE",url:null,variant:he},rightSource:{name:"NONE",url:null,variant:pe},tracking:!0,splitBorderVisible:!0,rightVideoOffset:0,showHelp:!me,showSourceSelector:!de,playReverse:!1,userDefinedPanZoom:!1},console.dir(a.state),a.onFullScreenChange=a.onFullScreenChange.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"setPosition",value:function(e){this.setState({position:e})}},{key:"setPlaying",value:function(e){this.setState({playing:e})}},{key:"setLeftSource",value:function(e){this.setState({leftSource:e})}},{key:"setRightSource",value:function(e){this.setState({rightSource:e})}},{key:"toggleTracking",value:function(){this.setState({tracking:!this.state.tracking})}},{key:"changeOffset",value:function(e){var t=this;0===e?this.setState({rightVideoOffset:e}):this.setState({rightVideoOffset:this.state.rightVideoOffset+e}),this.state.playing?this.pause().then((function(){return t.play()})):this.seek(this.leftVideo.currentTime())}},{key:"playPause",value:function(){this.state.playing?this.pause():this.play()}},{key:"step",value:function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.rightVideo.currentTime()+.04*t,this.rightVideo.quickSeek(n),this.leftVideo.quickSeek(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fullscreen",value:function(){var e;document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():(e=this.videoViewer).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"onTimeUpdate",value:function(e){this.setPosition(e)}},{key:"onDurationSet",value:function(e){this.setState({duration:e})}},{key:"syncPlayers",value:function(){this.leftVideo.seek(this.rightVideo.currentTime()),this.setPosition(this.leftVideo.currentTime())}},{key:"playForward",value:function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.playing){e.next=3;break}return e.next=3,this.pause();case 3:return this.leftVideo.playbackRate=1,this.rightVideo.playbackRate=1,e.abrupt("return",this.play());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.playing){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,Promise.all([this.rightVideo.play(),this.leftVideo.play()]);case 4:this.setPlaying(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createShareUrl",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"file"===this.state.leftSource.type||"file"===this.state.rightSource.type?alert("Shareable URL cannot be created since you are viewing a local file!"):(t=oe(this.state.leftSource.type)?"&leftVideoVariant=".concat(this.state.leftSource.variant):"",n=oe(this.state.rightSource.type)?"&rightVideoVariant=".concat(this.state.rightSource.variant):"",a="".concat(window.location.host).concat(window.location.pathname,"?position=").concat(this.state.position)+"&leftVideoUrl=".concat(this.state.leftSource.url).concat(t)+"&rightVideoUrl=".concat(this.state.rightSource.url).concat(n)+(se.get("hideSourceSelector")?"&hideSourceSelector=".concat(se.get("hideSourceSelector")):"")+(se.get("hideHelp")?"&hideHelp=".concat(se.get("hideHelp")):""),console.log("Copying to clipboard: "+a),ie(a));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.playing){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return this.rightVideo.pause(),this.leftVideo.pause(),this.setPlaying(!1),e.abrupt("return",this.seek(this.leftVideo.currentTime()));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"seek",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({position:t}),e.abrupt("return",Promise.all([this.leftVideo.seek(t),this.rightVideo.seek(t+.04*this.state.rightVideoOffset)]));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLeftVariantChange",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("left variant changed: ".concat(JSON.stringify(t))),e.next=3,this.changeVariant(this.leftVideo,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRightVariantChange",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("right variant changed: ".concat(JSON.stringify(t))),e.next=3,this.changeVariant(this.rightVideo,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLeftSourceChange",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changeSource(this.leftVideo,t);case 2:this.setLeftSource(t),this.splitView.focus();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRightSourceChange",value:function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changeSource(this.rightVideo,t);case 2:this.setRightSource(t),this.splitView.focus();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeVariant",value:function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.pauseAndExecute(t,Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({leftSource:Object.assign({},a.state.leftSource,{variant:n})}),e.next=3,t.setVariant(n);case 3:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"changeSource",value:function(){var e=Object(f.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Change source ".concat(n.url," ").concat(n.variant)),this.pauseAndExecute(t,Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadSource(n.url,n.variant);case 2:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"pauseAndExecute",value:function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a,i,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.playing,i=this.state.playReverse,e.next=4,this.pause();case 4:return r=t.currentTime(),console.log("".concat(JSON.stringify(t.props)," time: ").concat(r)),e.next=8,n();case 8:return e.next=10,this.seek(r);case 10:if(!a){e.next=13;break}return e.next=13,this.play();case 13:if(!i){e.next=16;break}return e.next=16,this.playReverse();case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"zoomIn",value:function(){this.leftVideo.zoomIn(),this.rightVideo.zoomIn(),this.setState({userDefinedPanZoom:!0})}},{key:"zoomOut",value:function(){this.leftVideo.zoomOut(),this.rightVideo.zoomOut(),this.setState({userDefinedPanZoom:!0})}},{key:"resetPanZoom",value:function(){this.leftVideo.resetPanZoom(),this.rightVideo.resetPanZoom(),this.setState({userDefinedPanZoom:!1})}},{key:"pan",value:function(e,t){this.leftVideo.pan(e,t),this.rightVideo.pan(e,t),this.setState({userDefinedPanZoom:!0})}},{key:"toggleShowHelp",value:function(){this.setState({showHelp:!this.state.showHelp})}},{key:"toggleSplitBorderVisible",value:function(){this.setState({splitBorderVisible:!this.state.splitBorderVisible})}},{key:"onFullScreenChange",value:function(){this.state.userDefinedPanZoom||this.resetPanZoom()}},{key:"componentDidMount",value:function(){this.splitView.focus(),this.seek(fe).catch((function(e){return console.trace(e)})),this.videoViewer.addEventListener("fullscreenchange",this.onFullScreenChange)}},{key:"componentWillUnmount",value:function(){this.videoViewer.removeEventListener("fullscreenchange",this.onFullScreenChange)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"video-viewer",tabIndex:"0",ref:this.setVideoViewerRef},i.a.createElement(Y,{position:this.state.position}),i.a.createElement(v.HotKeys,{className:"hotkeys-div",keyMap:Q,handlers:this.shortCutHandlers},i.a.createElement(W,{tracking:this.state.tracking,splitBorderVisible:this.state.splitBorderVisible,onDrag:function(t,n){return e.pan(t,n)},onClick:function(){return e.playPause()},ref:this.setSplitViewRef,leftSideContent:i.a.createElement(_,{muted:!0,ref:this.setLeftVideoRef})},i.a.createElement(_,{ref:this.setRightVideoRef,onTimeUpdate:function(t){return e.onTimeUpdate(t)},onDurationSet:function(t){return e.onDurationSet(t)}}),i.a.createElement("div",{className:y()("big-play-button",{hidden:this.state.playing||0!==this.state.position}),onClick:function(){return e.play()}},i.a.createElement(k.f,{size:"32px"}))),i.a.createElement(S,{visible:this.state.showSourceSelector,playing:this.state.playing,onPlay:function(){return e.playPause()},onStep:function(t){return e.step(t)},onFullscreen:function(){return e.fullscreen()},duration:this.state.duration,onSeek:function(t){return e.seek(t)},position:this.state.position}),i.a.createElement(G,{visible:this.state.showSourceSelector,className:"left-source-selector",defaultSource:ve,onChange:function(t){return e.onLeftSourceChange(t)},onVariantChange:function(t){return e.onLeftVariantChange(t)}}),i.a.createElement(G,{visible:this.state.showSourceSelector,className:"right-source-selector",defaultSource:ge,onChange:function(t){return e.onRightSourceChange(t)},onVariantChange:function(t){return e.onRightVariantChange(t)}}),i.a.createElement(q,{offset:this.state.rightVideoOffset}),i.a.createElement($,{visible:this.state.showHelp,onClick:function(){return e.toggleShowHelp()}}),i.a.createElement(ee,{onClick:function(){return e.toggleShowHelp()}})))}}]),n}(a.Component),ke=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(ye,null))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(ke,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[294,1,2]]]);
//# sourceMappingURL=main.5fbcd03f.chunk.js.map