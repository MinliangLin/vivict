{"version":3,"sources":["components/VideoViewer/VideoControls.js","util/HlsUtils.js","util/DashUtils.js","components/VideoViewer/VideoPlayer.js","util/Mp4Info.js","components/SourceSelector/index.js","components/SplitView/index.js","util/formatTime.js","components/VideoViewer/TimeDisplay.js","components/VideoViewer/OffsetIndicator.js","keymap.js","components/Help/index.js","util/CopyClipboard.js","util/SourceUtils.js","components/VideoViewer/index.js","util/FullscreenUtils.js","App.js","serviceWorker.js","index.js"],"names":["VideoControls","_ref","onPlay","onStep","onFullscreen","playing","onSeek","position","duration","react_default","a","createElement","className","onClick","event","stopPropagation","fi","cx","console","log","type","value","min","max","step","onInput","e","concat","target","nextPos","parseFloat","isHlsPlaylist","url","split","endsWith","parseHlsManifest","_x","_parseHlsManifest","apply","this","arguments","_callee","response","manifestText","parser","manifest","variants","regenerator_default","wrap","_context","prev","next","fetch","sent","text","Parser","push","end","playlists","map","playlist","Object","objectSpread","resolveVariantUrl","uri","bandwidth","attributes","BANDWIDTH","RESOLUTION","abrupt","mainUrl","selectedVariant","stop","variantUrl","indexOf","replace","parseDashManifest","_parseDashManifest","parse","JSON","stringify","i","index","isDashManifest","VideoPlayer","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","zoom","panHorizontal","panVertical","onTimeUpdate","bind","assertThisInitialized","onMetadataLoaded","setVideoRef","videoRef","videoElement","currentTime","onDurationSet","play","pause","pos","zoomFactor","newPanHorizontal","document","documentElement","clientWidth","newPanVertical","clientHeight","setState","deltaX","deltaY","offsetHeight","Promise","reject","resolve","_this2","addEventListener","once","variant","_this3","loadHls","loadDash","src","dash","setQualityFor","hls","currentLevel","_this4","detachMedia","attachSource","dashjs","MediaPlayer","create","updateSettings","streaming","fastSwitchEnabled","abr","autoSwitchBitrate","audio","video","initialize","Hls","loadSource","attachMedia","removeEventListener","width","parseInt","muted","ref","tabIndex","style","left","top","Component","fetchUntilDone","onData","isDone","chunkSize","res","data","start","responseData","_data","totalSize","_args","length","undefined","startsWith","arrayBuffer","fileStart","fetchRange","contentRange","Math","_callee2","range","_context2","method","headers","Range","ok","Error","status","t0","t1","get","t2","contentLength","mp4Info","_x6","_mp4Info","_callee3","done","mp4boxfile","mp4InfoPromise","_context3","MP4Box","createFile","onError","onReady","info","appendBuffer","catch","trace","SourceSelector","urlInputKeyDown","source","defaultSource","metadata","showUrlInput","visible","inputRef","input","mp4Metadata","videoTrack","videoTracks","bitrate","height","changeSource","keyCode","onUrlSelected","hideUrlInput","evt","files","onChange","name","file","window","URL","createObjectURL","setVariant","assign","onVariantChange","loadHlsMetadata","loadDashMetadata","loadMp4Metadata","prevSource","loadMetadata","then","revokeObjectURL","prevProps","prevState","snapshot","focus","round","metadataSpan","options","key","selected","formatMetadata","onVariantSelected","title","hidden","cursor","onFileSelected","setInputRef","onBlur","defaultValue","currentUrl","renderSelectedSource","SplitView","mouseMove","mouseDown","mouseUp","splitPercent","dragStart","dragging","setSplitViewContainerRef","splitViewContainer","setSplitViewClipperRef","splitViewClipper","passive","ignoreNextClick","x","clientX","y","clientY","nextProps","nextState","tracking","setSplitPosition","onDrag","movementX","movementY","trackLocation","rect","getBoundingClientRect","pageX","offsetWidth","show-border","splitBorderVisible","leftSideContent","children","zeroPad","num","formatTime","hours","floor","minutes","seconds","frames","TimeDisplay","OffsetIndicator","offset","sign","command","keys","description","COMMANDS","PLAY","PAUSE","PLAY_PAUSE","STEP_FORWARD_FRAME","STEP_BACKWARD_FRAME","STEP_FORWARD","STEP_BACKWARD","FULLSCREEN","SHARE","TOGGLE_TRACKING","LEFT_ONLY","RIGHT_ONLY","TIMESHIFT_DECREASE","TIMESHIFT_INCREASE","TIMESHIFT_RESET","ZOOM_IN","ZOOM_OUT","PAN_UP","PAN_DOWN","PAN_RIGHT","PAN_LEFT","REST_PAN_ZOOM","TOGGLE_HELP","TOGGLE_SPLIT_BORDER_VISIBLE","KEY_MAP","reduce","result","defineProperty","Help","generateKeymapHelp","copyrightText","githubLink","HelpButton","_ref2","href","copyToClipboard","dummy","body","appendChild","select","execCommand","removeChild","sourceType","isDashOrHls","urlParams","URLSearchParams","location","search","DEFAULT_SOURCE","av1","leftVideoUrl","rightVideoUrl","leftVideoVariant","Number","rightVideoVariant","startPosition","hideSourceSelector","Boolean","hideHelp","DEFAULT_SOURCE_LEFT","DEFAULT_SOURCE_RIGHT","VideoViewer","shortCutHandlers","playPause","fullscreen","toggleTracking","splitView","changeOffset","zoomIn","zoomOut","pan","resetPanZoom","createShareUrl","playForward","toggleShowHelp","toggleSplitBorderVisible","slicedToArray","action","setVideoViewerRef","videoViewer","setRightVideoRef","rightVideo","setLeftVideoRef","leftVideo","setSplitViewRef","leftSource","rightSource","rightVideoOffset","showHelp","showSourceSelector","playReverse","userDefinedPanZoom","dir","onFullScreenChange","delta","seek","steps","newTime","quickSeek","elem","fullScreen","mozFullScreen","webkitIsFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","time","setPosition","playbackRate","all","setPlaying","alert","leftVariantParam","rightVariantParam","path","host","pathname","changeVariant","setLeftSource","setRightSource","pauseAndExecute","asyncToGenerator","mark","_callee11","_context11","_callee13","_context13","wasPlaying","wasPlayingReverse","VideoViewer_TimeDisplay","index_es","keyMap","handlers","src_components_SplitView","dx","dy","VideoViewer_VideoPlayer","size","VideoViewer_VideoControls","n","src_components_SourceSelector","onLeftSourceChange","onLeftVariantChange","onRightSourceChange","onRightVariantChange","VideoViewer_OffsetIndicator","Help_Help","Help_HelpButton","App","src_components_VideoViewer","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.24b242ac.chunk.js","sourcesContent":["import React from 'react';\nimport cx from 'classnames';\nimport {FiPlay, FiPause, FiSkipBack, FiSkipForward, FiMaximize} from 'react-icons/fi';\n\n\nconst VideoControls = ({onPlay, onStep, onFullscreen, playing, onSeek, position, duration}) => {\n\n    return (<div className=\"controls\">\n        <button className=\"btn btn-default\" onClick={(event) => {\n            onStep(-1);\n            event.stopPropagation();\n        }}><FiSkipBack /></button>\n        <button className={cx('btn', 'btn-default') }\n                onClick={(event) => {\n                    console.log('play/pause: ' );\n                    onPlay();\n                    event.stopPropagation();\n                }}>{playing ? (<FiPause/>) : (<FiPlay />)}</button>\n        <button className=\"btn btn-default\" onClick={(event) => {\n            onStep(1);\n            event.stopPropagation();\n        }}><FiSkipForward/></button>\n\n        <input type=\"range\" value={position} min=\"0\" max={duration} step=\"0.04\" onInput={(e) => {\n            console.log(`range value: ${e.target.value}`);\n            const nextPos = parseFloat(e.target.value);\n            onSeek(nextPos);\n            e.stopPropagation();\n        }} />\n\n        <button className=\"btn btn-default glyphicon glyphicon-fullscreen\" onClick={(event) => {\n            onFullscreen();\n            event.stopPropagation();\n        }}><FiMaximize/></button>\n    </div>)\n};\n\nexport default VideoControls;","import {Parser} from 'm3u8-parser';\n\nexport function isHlsPlaylist(url) {\n    if (!url) return false;\n    return url.split('?')[0].endsWith('.m3u8');\n}\n\nexport async function parseHlsManifest(url) {\n    const response = await fetch(url);\n    const manifestText = await response.text();\n    const parser = new Parser();\n    parser.push(manifestText);\n    parser.end();\n    const manifest = parser.manifest;\n    const variants = manifest.playlists.map( playlist => {\n        return {\n            url: resolveVariantUrl(url, playlist.uri),\n            bandwidth: playlist.attributes.BANDWIDTH,\n            ...playlist.attributes.RESOLUTION,\n        };\n    });\n    return {\n        mainUrl: url,\n        variants,\n        selectedVariant: 0\n    };\n}\n\nfunction resolveVariantUrl(mainUrl, variantUrl) {\n    if (isAbsoluteUrl(variantUrl)) {\n        return variantUrl;\n    }\n    return mainUrl.replace(/\\/[^/]*$/, '/' + variantUrl)\n}\n\nfunction isAbsoluteUrl(url) {\n    return (url.indexOf('http://') === 0 || url.indexOf('https://') === 0)\n}","import {parse} from \"mpd-parser/src/\";\n\nexport async function parseDashManifest(url) {\n    const response = await fetch(url);\n    const manifestText = await response.text();\n    console.log(\"RAW DASH MANIFEST:\" + manifestText);\n    const manifest = parse(manifestText);\n    console.log(\"DASH MANIFEST:\\n\" + JSON.stringify(manifest));\n\n    const variants = manifest.playlists.map( (playlist, i) => {\n        return {\n            url: null,\n            index: i,\n            bandwidth: playlist.attributes.BANDWIDTH,\n            ...playlist.attributes.RESOLUTION,\n        };\n    });\n    return {\n        mainUrl: url,\n        variants,\n        selectedVariant: 0\n    };\n}\n\nexport function isDashManifest(url) {\n    if (!url) return false;\n    return url.split('?')[0].endsWith('.mpd');\n}\n","import React, {Component} from 'react';\nimport Hls from 'hls.js'\nimport dashjs from 'dashjs';\nimport {isHlsPlaylist} from \"../../util/HlsUtils\";\nimport {isDashManifest} from \"../../util/DashUtils\";\n\nconst zoomInMultiplier = 1.1;\nconst zoomOutMultiplier = 1/zoomInMultiplier;\n\nclass VideoPlayer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            zoom: 1,\n            panHorizontal: 0,\n            panVertical: 0\n        };\n        this.onTimeUpdate = this.onTimeUpdate.bind(this);\n        this.onMetadataLoaded = this.onMetadataLoaded.bind(this);\n        this.setVideoRef =  (videoRef) => {\n            this.videoElement = videoRef;\n        };\n    }\n\n    onTimeUpdate() {\n        if (this.props.onTimeUpdate) {\n            this.props.onTimeUpdate(this.videoElement.currentTime);\n        }\n    }\n\n    onMetadataLoaded() {\n        if (this.props.onDurationSet) {\n            this.props.onDurationSet(this.videoElement.duration);\n        }\n    }\n\n    async play() {\n        return this.videoElement.play();\n    }\n\n    pause() {\n        this.videoElement.pause();\n    }\n\n    quickSeek(pos) {\n        this.videoElement.currentTime = pos;\n    }\n\n    zoomIn() {\n        this.zoom(zoomInMultiplier);\n    }\n\n    zoomOut() {\n        this.zoom(zoomOutMultiplier);\n    }\n\n    zoom(zoomFactor) {\n        const newPanHorizontal = (1 - zoomFactor ) / 2 * document.documentElement.clientWidth +\n            zoomFactor * this.state.panHorizontal;\n        const newPanVertical = (1 - zoomFactor) / 2 * document.documentElement.clientHeight +\n            zoomFactor * this.state.panVertical;\n        this.setState({\n            zoom: this.state.zoom * zoomFactor,\n            panHorizontal: newPanHorizontal,\n            panVertical: newPanVertical\n        });\n    }\n\n    pan(deltaX, deltaY) {\n        this.setState({\n            panHorizontal: this.state.panHorizontal + deltaX,\n            panVertical: this.state.panVertical + deltaY});\n    }\n\n    resetPanZoom() {\n        const clientHeight = document.documentElement.clientHeight;\n        const videoElementHeight = this.videoElement.offsetHeight / this.state.zoom;\n        const panVertical = (clientHeight - videoElementHeight) / 2;\n        this.setState({\n            zoom: 1,\n            panHorizontal: 0,\n            panVertical: panVertical\n        });\n    }\n\n    async seek(pos) {\n        if (pos > this.videoElement.duration) {\n            return Promise.reject(`Invalid seek position: ${pos}, media duration is ${this.videoElement.duration}`);\n        }\n        return new Promise((resolve, reject) => {\n            this.videoElement.addEventListener('seeked', () => {\n                resolve();\n            }, { once: true});\n            this.videoElement.currentTime = pos;\n        })\n    }\n\n\n    async loadSource(url, variant) {\n        console.log(`load source: ${url} ${variant}`);\n        return new Promise((resolve, reject) => {\n            this.videoElement.addEventListener('canplay',\n                () => {\n                    resolve();\n                },\n                { once: true });\n            if (isHlsPlaylist(url)) {\n                this.loadHls(url, variant)\n            } else if (isDashManifest(url)) {\n                this.loadDash(url, variant);\n            } else {\n                this.videoElement.src = url;\n            }\n        });\n    }\n\n    setVariant(variant) {\n        console.log(`setVariant: ${variant}`);\n        if (this.state.dash) {\n            this.state.dash.setQualityFor('video', variant);\n        } else if (this.state.hls) {\n            this.state.hls.currentLevel = variant;\n        }\n    }\n\n    loadDash(url, variant) {\n        if (this.state.hls) {\n            this.state.hls.detachMedia();\n            this.setState({hls: null});\n        }\n        let dash = this.state.dash;\n        this.videoElement.addEventListener('canplay',\n            () => {\n                this.state.dash.setQualityFor('video', variant);\n            },\n            {once: true});\n        if (!dash) {\n            dash = dashjs.MediaPlayer().create();\n            this.setState({dash});\n            dash.updateSettings({\n                streaming: {\n                    fastSwitchEnabled: true,\n                    abr: {\n                        autoSwitchBitrate: {audio: false, video: false}\n                    }\n                }\n            });\n            dash.initialize(this.videoElement, url, false);\n        } else {\n            dash.attachSource(url);\n        }\n    }\n\n    loadHls(url, variant) {\n        this.setState({dash: null});\n        let hls = this.state.hls;\n        if (!hls) {\n            hls = new Hls();\n            this.setState({hls});\n        }\n        hls.loadSource(url);\n        hls.attachMedia(this.videoElement);\n        hls.currentLevel = variant;\n    }\n\n    currentTime() {\n        return this.videoElement.currentTime;\n    }\n\n    componentDidMount() {\n        this.videoElement.addEventListener('timeupdate', this.onTimeUpdate);\n        this.videoElement.addEventListener('loadedmetadata', this.onMetadataLoaded)\n    }\n\n    componentWillUnmount() {\n        this.videoElement.removeEventListener('timeupdate', this.onTimeUpdate);\n        this.videoElement.removeEventListener('loadedmetadata', this.onMetadataLoaded)\n    }\n\n    render() {\n        const width = parseInt(100 * this.state.zoom) + 'vw';\n        return (\n            <video muted={this.props.muted} ref={this.setVideoRef}\n                   tabIndex=\"-1\"\n                   style={{\n                       width: width,\n                       left: this.state.panHorizontal + 'px',\n                       top: this.state.panVertical + 'px'\n                   }}\n            >\n            </video>\n        )\n    }\n}\n\nexport default VideoPlayer;","import MP4Box from 'mp4box';\n\nasync function fetchUntilDone(url, onData,isDone, chunkSize = 10 * 1024 * 1024) {\n    if (url.startsWith(\"blob:\")) {\n        const res = await fetch(url);\n        const data = await res.arrayBuffer();\n        data.fileStart = 0;\n        onData(data);\n        return;\n    }\n    let start = 0;\n    let end = chunkSize;\n    while(!isDone()) {\n        const responseData = await fetchRange(url, {start, end});\n        const data = responseData.data;\n        const totalSize = parseInt(responseData.contentRange.split('/')[1]);\n        data.fileStart = start;\n        onData(data);\n        if (end === totalSize) break;\n        start = end;\n        end = Math.min(totalSize, start + chunkSize);\n        if (data.length  < chunkSize) break;\n    }\n}\n\nasync function fetchRange(url, range) {\n    const response = await fetch(url, {\n        method: \"GET\",\n        headers: {\n            'Range': `bytes=${range.start}-${range.end}`\n        }\n    });\n    if (!response.ok) {\n        throw Error(`Fetch failed with status: ${response.status}`);\n    }\n    return {\n        data: await response.arrayBuffer(),\n        contentLength: response.headers.get('Content-Length'),\n        contentRange:  response.headers.get('Content-Range')\n    }\n}\n\nexport async function mp4Info(url) {\n    console.log(`mp4Info: ${url}`);\n    let done = false;\n    const mp4boxfile = new MP4Box.createFile();\n\n    const mp4InfoPromise = new Promise((resolve, reject) => {\n        mp4boxfile.onError = e => {\n            done = true;\n            console.log(e);\n            reject(e);\n        };\n\n        mp4boxfile.onReady = (info) => {\n            done = true;\n            resolve(info);\n        };\n    });\n\n    fetchUntilDone(url,\n        (data) => {\n            mp4boxfile.appendBuffer(data)\n        },\n        () => done)\n        .catch(e => {\n            console.log(`error: ${e}`);\n            console.trace(e);\n        });\n\n    return mp4InfoPromise\n}","import React, {Component} from 'react';\nimport {FiFile, FiGlobe} from \"react-icons/fi\";\nimport cx from 'classnames';\nimport './index.css';\nimport {isHlsPlaylist, parseHlsManifest} from '../../util/HlsUtils';\nimport {mp4Info} from '../../util/Mp4Info';\nimport {isDashManifest, parseDashManifest} from \"../../util/DashUtils\";\n\nclass SourceSelector extends Component {\n\n    constructor(props) {\n        super(props);\n        this.stopPropagation = this.stopPropagation.bind(this);\n        this.urlInputKeyDown = this.urlInputKeyDown.bind(this);\n        this.state = {\n            source: this.props.defaultSource,\n            metadata: null,\n            showUrlInput: false,\n            visible: this.props.visible\n        };\n    }\n\n    setInputRef(inputRef) {\n        this.input = inputRef;\n    }\n\n    async loadHlsMetadata(url) {\n        const metadata = await parseHlsManifest(url);\n        this.setState({metadata});\n    }\n\n    async loadDashMetadata(url) {\n        const metadata = await parseDashManifest(url);\n        this.setState({metadata})\n    }\n\n    async loadMp4Metadata(url) {\n        const mp4Metadata = await mp4Info(url);\n\n        const videoTrack = mp4Metadata.videoTracks[0];\n        const metadata = {\n            variants: [\n                {\n                    bitrate: videoTrack.bitrate,\n                    width: videoTrack.video.width,\n                    height: videoTrack.video.height\n                }\n            ]\n        };\n        this.setState({metadata})\n    }\n\n    componentDidMount() {\n        this.changeSource(this.state.source);\n        console.log('Source selector add event listeners');\n        this.input.addEventListener('keydown', this.urlInputKeyDown);\n        this.input.addEventListener('keypress', this.stopPropagation);\n        this.input.addEventListener('keyup', this.stopPropagation);\n    }\n\n    componentWillUnmount() {\n        this.input.removeEventListener('keydown', this.urlInputKeyDown);\n        this.input.removeEventListener('keypress', this.stopPropagation);\n        this.input.removeEventListener('keyup', this.stopPropagation);\n    }\n\n    stopPropagation(e) {\n        e.stopPropagation();\n    }\n\n    urlInputKeyDown(e) {\n        e.stopPropagation();\n        switch (e.keyCode) {\n            case 13:\n                this.onUrlSelected(e.target.value);\n                break;\n            case 27:\n                this.hideUrlInput();\n                break;\n            default:\n        }\n    }\n\n    onBlur() {\n        console.log('onBlur');\n        this.setState({showUrlInput: false})\n    }\n\n    handleChange(evt) {\n        if (evt.target.files) {\n            this.props.onChange(evt.target.files[0])\n        }\n    }\n\n    showUrlInput() {\n        this.setState({showUrlInput: true});\n    }\n\n    hideUrlInput() {\n        this.setState({showUrlInput: false});\n    }\n\n    onUrlSelected(url) {\n        console.log(`url: ${url}`);\n        this.hideUrlInput();\n        let type = 'url';\n        if (isHlsPlaylist(url)) {\n            type = 'hls';\n        } else if (isDashManifest(url)) {\n            type = 'dash';\n        }\n        this.changeSource({\n            type,\n            name: url,\n            url: url,\n            variant: 0\n        })\n    }\n\n    onFileSelected(evt) {\n        if (evt.target.files && evt.target.files[0]) {\n            const file = evt.target.files[0];\n            this.changeSource({\n                type: 'file',\n                name: file.name,\n                url: window.URL.createObjectURL(file),\n            });\n        }\n    }\n\n    onVariantSelected(evt) {\n        const selectedVariant = parseInt(evt.target.value);\n        this.setVariant(selectedVariant);\n    }\n\n    setVariant(selectedVariant) {\n        const source = Object.assign({}, this.state.source, {variant: selectedVariant});\n        this.setState({source});\n        if (this.props.onVariantChange) {\n            this.props.onVariantChange(selectedVariant);\n        }\n    }\n\n    async loadMetadata(source) {\n        if (source.type === 'hls') {\n            await this.loadHlsMetadata(source.url)\n        } else if (source.type === 'dash') {\n            await this.loadDashMetadata(source.url);\n        } else {\n            await this.loadMp4Metadata(source.url);\n        }\n    }\n\n    changeSource(source) {\n        const prevSource = this.state.source;\n        this.loadMetadata(source)\n            .then(() => {\n                this.setState({source});\n                this.props.onChange(Object.assign({}, source));\n                if (prevSource.type === 'file' && prevSource.url) {\n                    window.URL.revokeObjectURL(prevSource.url);\n                }\n            });\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.state.showUrlInput) {\n            this.input.focus()\n        }\n    }\n\n    currentUrl() {\n        return this.state.source.type === 'file' ? '' : this.state.source.url;\n    }\n\n    formatMetadata(bitrate, width, height) {\n        return `[${Math.round(bitrate / 1000)}kbit/s ${width}x${height}]`\n    }\n\n    renderSelectedSource() {\n        if (this.state.showUrlInput) {\n            return null;\n        }\n        const metadata = this.state.metadata;\n        let metadataSpan = null;\n        if (metadata) {\n            if (metadata.variants.length > 1) {\n                const options = metadata.variants.map( (variant, i) => {\n                    return (<option\n                        key={i}\n                        value={i}\n                        selected={i === this.state.source.variant}\n                    >\n                        {this.formatMetadata(variant.bandwidth,variant.width, variant.height)}\n                    </option>);\n                });\n                metadataSpan = (<select value={this.state.selectedVariant} onChange={(e) => this.onVariantSelected(e)}>{options}</select>);\n            } else if (metadata.variants.length === 1) {\n                const variant = metadata.variants[0];\n                metadataSpan = (<span>{this.formatMetadata(variant.bitrate, variant.width, variant.height)}</span>);\n            }\n        }\n        return (<div className=\"source-metadata\">\n            <div className=\"source-name\" title={this.state.source.name}>{this.state.source.name}</div>\n            <div>{metadataSpan}</div>\n        </div>);\n    }\n\n    render() {\n        return (\n            <div className={cx(\"source-selector\", this.props.className, {'hidden': !this.props.visible})}>\n                <div className=\"source-buttons\">\n                    <div title=\"open URL\" className=\"url-button\" >\n                        <FiGlobe style={{cursor: 'pointer'}} onClick={() => this.showUrlInput()}/>\n                    </div>\n                    <label title=\"open local file\" className=\"source-file-input\" onClick={(evt) => {\n                        this.hideUrlInput();\n                        evt.stopPropagation()\n                    }}>\n                        <FiFile/>\n                        <input type=\"file\" onChange={(evt) => this.onFileSelected(evt) }/>\n                    </label>\n                </div>\n\n                <input className={cx('url-input',\n                    {hidden: !this.state.showUrlInput})}\n                       type=\"text\"\n                       ref={(ref) => this.setInputRef(ref)}\n                       onBlur={() => this.onBlur()}\n                       defaultValue={this.currentUrl()}\n                />\n\n                {this.renderSelectedSource()}\n\n            </div>\n        )\n    }\n}\n\nexport default SourceSelector;","import  React, {Component} from 'react';\nimport cx from 'classnames';\nimport './index.css';\n\n\nclass SplitView extends Component {\n    constructor(props) {\n        super(props);\n        this.mouseMove = this.mouseMove.bind(this);\n        this.mouseDown = this.mouseDown.bind(this);\n        this.mouseUp = this.mouseUp.bind(this);\n        console.log('Split view constructor');\n\n        this.state = {\n            splitPercent: 0,\n            dragStart: null,\n            dragging: false\n        };\n\n        this.setSplitViewContainerRef = splitViewContainer => {\n            this.splitViewContainer = splitViewContainer;\n\n        };\n\n        this.setSplitViewClipperRef = splitViewClipper => {\n            this.splitViewClipper = splitViewClipper;\n        };\n    }\n\n    componentDidMount() {\n        this.splitViewContainer.addEventListener(\"mousemove\", this.mouseMove, {passive: true});\n        this.splitViewContainer.addEventListener(\"mousedown\", this.mouseDown);\n        document.addEventListener(\"mouseup\", this.mouseUp);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener(\"mouseup\", this.mouseUp);\n        this.splitViewContainer.removeEventListener(\"mousedown\", this.mouseDown);\n        this.splitViewContainer.removeEventListener(\"mousemove\", this.mouseMove, {passive: true});\n    }\n\n    mouseUp(e) {\n        if (this.state.dragging) {\n            this.ignoreNextClick = true;\n        }\n        this.setState({dragStart: null, dragging: false});\n    }\n\n    onClick(e) {\n        if (this.ignoreNextClick) {\n            this.ignoreNextClick = false;\n        } else {\n            this.props.onClick(e);\n        }\n    }\n\n    mouseDown(e) {\n        this.setState({dragStart: {x: e.clientX, y: e.clientY}});\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return true;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.tracking && !prevProps.tracking) {\n            this.setSplitPosition(this.state.splitPercent);\n        }\n    }\n\n    mouseMove(e) {\n        if (this.state.dragStart) {\n            this.setState({dragging: true});\n            this.props.onDrag(e.movementX, e.movementY);\n        } else {\n            this.trackLocation(e);\n        }\n    }\n\n    trackLocation(e) {\n        if (!this.splitViewContainer) {\n            return;\n        }\n        const rect = this.splitViewContainer.getBoundingClientRect();\n        const position = ((e.pageX - rect.left) / this.splitViewContainer.offsetWidth)*100;\n        if (position <= 100) {\n            this.setState({splitPercent: position});\n            if (this.props.tracking) {\n                this.setSplitPosition(position);\n            }\n        }\n    }\n\n    setSplitPosition(position) {\n        this.splitViewClipper.style.width = position+\"%\";\n    }\n\n    focus() {\n        this.splitViewContainer.focus();\n    }\n\n    render() {\n        return (\n            <div className={cx('split-view-container', {'dragging': this.state.dragging})} ref={(ref) => this.setSplitViewContainerRef(ref)}\n            tabIndex=\"-1\"\n            onClick={(e) => this.onClick(e) }>\n                <div className={cx(\"split-view-clipper\", {\"show-border\": this.props.splitBorderVisible})} ref={(ref) => this.setSplitViewClipperRef(ref)}>\n                    {this.props.leftSideContent}\n                </div>\n                {this.props.children}\n            </div>\n        )\n    }\n}\n\nexport default SplitView;\n","function formatTime(position) {\n    const hours = Math.floor(position / 3600);\n    const minutes = Math.floor((position % 3600) / 60);\n    const seconds = Math.floor(position % 60);\n    const frames = Math.floor((position - Math.floor(position)) / 0.04);\n    return zeroPad(hours) + ':' + zeroPad(minutes) + ':'\n        + zeroPad(seconds) + '.' + zeroPad(frames);\n}\n\nfunction zeroPad(num) {\n    return num < 10 ? '0' + num : '' + num;\n}\n\nexport default formatTime;","import React from 'react';\nimport formatTime from '../../util/formatTime';\n\nconst TimeDisplay = ({position}) => (<div className=\"time-display\">{formatTime(position)}</div>);\n\nexport default TimeDisplay;","import React from 'react';\n\nfunction sign(offset) {\n    return offset > 0 ? '+' : '';\n}\n\nconst OffsetIndicator = ({offset}) => {\n    if (offset === 0.0) {\n        return null;\n    }\n    return (<div className=\"offset-indicator\">offset: {sign(offset)}{offset * 0.04}</div>)\n};\n\nexport default OffsetIndicator;","\n\nconst command = (name, keys, description) => ({\n        name,\n        keys,\n        description\n});\n\nexport const COMMANDS = {\n        PLAY: command('PLAY', 'l', 'Play video'),\n        PAUSE: command('PAUSE', 'k', 'Pause video'),\n        PLAY_PAUSE: command('PLAY_PAUSE', 'space', 'Play/Pause video'),\n        STEP_FORWARD_FRAME: command('STEP_FORWARD_FRAME', '.', 'Step forward 1 frame'),\n        STEP_BACKWARD_FRAME: command('STEP_BACKWARD_FRAME', ',', 'Step backward 1 frame'),\n        STEP_FORWARD: command('STEP_FORWARD', ['/', '-'], 'Step forward 1 second'),\n        STEP_BACKWARD: command('STEP_BACKWARD', 'm', 'Step backward 1 second'),\n        FULLSCREEN: command('FULLSCREEN', 'f', 'Toggle full screen'),\n        SHARE: command('SHARE', 'c', 'Copy shareable url to clipboard'),\n        TOGGLE_TRACKING: command('TOGGLE_TRACKING', 't', 'Toggle split position follows mouse'),\n        LEFT_ONLY: command('LEFT_ONLY', ']', 'View only left video'),\n        RIGHT_ONLY: command('RIGHT_ONLY', '[', 'View only right video'),\n        TIMESHIFT_DECREASE: command('OFFSET_DECREASE', '<', 'Decrease timeshift between videos'),\n        TIMESHIFT_INCREASE: command('OFFSET_INCREASE', '>', 'Increase timeshift between videos'),\n        TIMESHIFT_RESET: command('OFFSET_RESET', 'r', 'Reset timeshift between videos'),\n        ZOOM_IN: command('ZOOM_IN', 'u', 'Zoom in'),\n        ZOOM_OUT: command('ZOOM_OUT', 'i', 'Zoom out'),\n        PAN_UP: command('PAN_UP', 'up', 'Pan up'),\n        PAN_DOWN: command('PAN_DOWN', 'down', 'Pan down'),\n        PAN_RIGHT: command('PAN_RIGHT', 'right', 'Pan right'),\n        PAN_LEFT: command('PAN_LEFT', 'left', 'Pan left'),\n        REST_PAN_ZOOM: command('RESET_PAN_ZOOM', '0', 'Reset pan and zoom to default'),\n        TOGGLE_HELP: command('TOOGLE_HELP', 'esc', 'Toggle help window'),\n        TOGGLE_SPLIT_BORDER_VISIBLE: command('TOGGLE_SPLIT_BORDER_VISIBLE', 's', 'Toggle split border visible')\n};\n\n\nexport const KEY_MAP = Object.keys(COMMANDS).reduce((result, key) => Object.assign(result, {[COMMANDS[key].name]: COMMANDS[key].keys}), {});\n\nconsole.log(`KEY_MAP: ${JSON.stringify(KEY_MAP)}`);","import React from 'react';\nimport cx from 'classnames';\nimport {FiHelpCircle, FiX} from \"react-icons/fi\";\nimport './index.css';\nimport {COMMANDS} from '../../keymap';\n\n\nconst Help = ({visible, onClick}) => (\n    <div className={cx('help', {'hidden': !visible})}>\n        <div className='help-header'>\n            <h3 className={\"padding10\"}>Vivict - Vivict Video Comparison Tool</h3>\n            <div className='close-button' onClick={() => onClick()}>\n                <FiX />\n            </div>\n        </div>\n        <div>\n            <h4 className={\"padding10\"}>Keybindings:</h4>\n            {generateKeymapHelp()}\n            {copyrightText()}\n            {githubLink()}\n        </div>\n    </div>);\n\nconst HelpButton = ({onClick, className}) => (\n    <div className={\"help-button \" + className}\n    onClick={(e) => onClick(e)}>\n        <FiHelpCircle/>\n    </div>\n);\n\nconst generateKeymapHelp = () => {\n    //return Array.from(KEY_MAP, ([key, value]) => (\n    return Object.keys(COMMANDS).map(key => {\n        const command = COMMANDS[key];\n        return (\n            <div key={\"keybinding-\" + command.name}><span className={\"bold\"}>{command.keys}</span>{\"  \" + command.description}</div>\n        )\n    });\n};\n\nconst copyrightText = () => {\n    return (\n        <h4 className={\"padding10\"}>Copyright 2019 Sveriges Television AB.</h4>\n    )\n};\n\nconst githubLink = () => {\n    return <a href=\"https://github.com/SVT/vivict\" >Contribute on Github, released under MIT</a>\n};\n\nexport {Help, HelpButton}","export function copyToClipboard(text) {\n    let dummy = document.createElement(\"textarea\");\n    document.body.appendChild(dummy);\n    dummy.value = text;\n    dummy.select();\n    document.execCommand(\"copy\");\n    document.body.removeChild(dummy);\n}","import {isHlsPlaylist} from \"./HlsUtils\";\nimport {isDashManifest} from \"./DashUtils\";\n\nexport function sourceType(url) {\n    if (isHlsPlaylist(url)) {\n        return 'hls'\n    }\n    if (isDashManifest(url)) {\n        return 'dash';\n    }\n    return 'url';\n}\n\nexport function isDashOrHls(type) {\n    return type === 'hls' || type === 'dash';\n}","import React, {Component} from 'react';\nimport {HotKeys} from 'react-hotkeys';\nimport VideoControls from './VideoControls';\nimport VideoPlayer from './VideoPlayer';\nimport './index.css';\nimport SourceSelector from '../SourceSelector'\nimport SplitView from '../SplitView';\nimport TimeDisplay from './TimeDisplay';\nimport OffsetIndicator from './OffsetIndicator';\nimport {Help, HelpButton} from '../Help';\nimport {COMMANDS, KEY_MAP} from '../../keymap'\nimport {openFullscreen, isFullscreen, closeFullscreen} from \"../../util/FullscreenUtils\";\nimport {copyToClipboard} from \"../../util/CopyClipboard\";\nimport {FiPlay} from 'react-icons/fi';\nimport cx from 'classnames';\nimport {isHlsPlaylist} from \"../../util/HlsUtils\";\nimport {isDashOrHls, sourceType} from \"../../util/SourceUtils\";\n\nconst DEFAULT_SOURCES = {\n    hls: \"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8\",\n    dash: \"https://dash.akamaized.net/dash264/TestCases/2a/qualcomm/1/MultiResMPEG2.mpd\",\n    av1: \"https://storage.googleapis.com/bitmovin-demos/av1/stream.mpd\"\n};\n\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst DEFAULT_SOURCE = DEFAULT_SOURCES[urlParams.get('defaultSource') ? urlParams.get('defaultSource') : 'hls'];\nconst leftVideoUrl = urlParams.get('leftVideoUrl') || DEFAULT_SOURCE;\nconst rightVideoUrl = urlParams.get('rightVideoUrl') || leftVideoUrl;\nconst leftVideoVariant = Number(urlParams.get('leftVideoVariant')) || 0;\nconst rightVideoVariant = Number(urlParams.get('rightVideoVariant')) || 0;\nconst startPosition = Number(urlParams.get('position')) || 0;\nconst hideSourceSelector = Boolean(urlParams.get('hideSourceSelector'));\nconst hideHelp = Boolean(urlParams.get('hideHelp'));\n\nconst DEFAULT_SOURCE_LEFT = {\n    type: sourceType(leftVideoUrl),\n    name: leftVideoUrl,\n    url: leftVideoUrl,\n    variant: leftVideoVariant,\n    position: startPosition\n};\nconst DEFAULT_SOURCE_RIGHT = {\n    type:  sourceType(rightVideoUrl),\n    name: rightVideoUrl,\n    url: rightVideoUrl,\n    variant: rightVideoVariant,\n    position: startPosition\n};\n\nclass VideoViewer extends Component {\n    constructor(props) {\n        super(props);\n        this.setVideoViewerRef = videoViewer => {\n            this.videoViewer = videoViewer;\n        };\n        this.setRightVideoRef = rightVideo => {\n            console.log('setRightVideoRef', rightVideo);\n            this.rightVideo = rightVideo;\n        };\n        this.setLeftVideoRef = leftVideo => {\n            this.leftVideo = leftVideo;\n        };\n        this.setSplitViewRef = splitView => {\n            this.splitView = splitView;\n        };\n        this.state = {\n            playing: false,\n            duration: 0,\n            position: 0,\n            leftSource: {name: \"NONE\", url: null, variant: leftVideoVariant},\n            rightSource:{name: \"NONE\", url: null, variant: rightVideoVariant},\n            tracking: true,\n            splitBorderVisible: true,\n            rightVideoOffset: 0,\n            showHelp: !hideHelp,\n            showSourceSelector: !hideSourceSelector,\n            playReverse: false,\n            userDefinedPanZoom: false\n        };\n        console.dir(this.state);\n\n        this.onFullScreenChange = this.onFullScreenChange.bind(this);\n    }\n\n    setPosition(position) {\n        this.setState({position});\n    }\n\n    setPlaying(playing) {\n        this.setState({playing})\n    }\n\n    setLeftSource(leftSource) {\n        this.setState({leftSource})\n    }\n\n    setRightSource(rightSource) {\n        this.setState({rightSource})\n    }\n\n    toggleTracking() {\n        this.setState({tracking: !this.state.tracking})\n    }\n\n    changeOffset(delta) {\n\n        if(delta === 0) {\n            this.setState({rightVideoOffset: delta});\n        } else {\n            this.setState({rightVideoOffset: this.state.rightVideoOffset + delta});\n        }\n\n        if (!this.state.playing) {\n            this.seek(this.leftVideo.currentTime());\n        } else {\n            this.pause()\n                .then(() => this.play())\n        }\n    }\n\n    playPause() {\n        if(this.state.playing) {\n            this.pause();\n        } else {\n            this.play();\n        }\n    }\n\n    async step(steps) {\n        const newTime = this.rightVideo.currentTime() + 0.04 * steps;\n        this.rightVideo.quickSeek(newTime);\n        this.leftVideo.quickSeek(newTime);\n    }\n\n    fullscreen() {\n        if(isFullscreen()) {\n            closeFullscreen();\n        } else {\n            openFullscreen(this.videoViewer);\n        }\n    }\n\n    onTimeUpdate(time) {\n        this.setPosition(time);\n    }\n\n    onDurationSet(duration) {\n        this.setState({duration})\n    }\n\n    syncPlayers() {\n        this.leftVideo.seek(this.rightVideo.currentTime());\n        this.setPosition(this.leftVideo.currentTime());\n    }\n\n    async playForward() {\n        if (this.state.playing) {\n            await this.pause();\n        }\n        this.leftVideo.playbackRate = 1;\n        this.rightVideo.playbackRate = 1;\n        return this.play();\n    }\n\n    async play() {\n        if(this.state.playing) {\n            return Promise.resolve();\n        }\n        await Promise.all([this.rightVideo.play(), this.leftVideo.play()])\n        this.setPlaying(true);\n\n    }\n\n    async createShareUrl() {\n        if (this.state.leftSource.type === 'file' || this.state.rightSource.type === 'file') {\n            alert(\"Shareable URL cannot be created since you are viewing a local file!\");\n        } else {\n            const leftVariantParam = isDashOrHls(this.state.leftSource.type) ?\n                `&leftVideoVariant=${this.state.leftSource.variant}` : \"\";\n            const rightVariantParam = isDashOrHls(this.state.rightSource.type) ?\n                `&rightVideoVariant=${this.state.rightSource.variant}` : \"\";\n            const path = `${window.location.host}${window.location.pathname}?position=${this.state.position}`\n            + `&leftVideoUrl=${this.state.leftSource.url}${leftVariantParam}`\n            + `&rightVideoUrl=${this.state.rightSource.url}${rightVariantParam}`\n            + (urlParams.get('hideSourceSelector') ? `&hideSourceSelector=${urlParams.get('hideSourceSelector')}` : \"\")\n            + (urlParams.get('hideHelp') ? `&hideHelp=${urlParams.get('hideHelp')}` : \"\")\n            console.log(\"Copying to clipboard: \" + path);\n            copyToClipboard(path)\n        }\n    }\n\n    async pause() {\n        if (!this.state.playing) {\n            return Promise.resolve();\n        }\n        this.rightVideo.pause();\n        this.leftVideo.pause();\n        this.setPlaying(false);\n        return this.seek(this.leftVideo.currentTime());\n    }\n\n    async seek(pos) {\n        this.setState({position: pos});\n        return Promise.all([this.leftVideo.seek(pos), this.rightVideo.seek(pos + this.state.rightVideoOffset * 0.04)]);\n    }\n\n    async onLeftVariantChange(variant) {\n        console.log(`left variant changed: ${JSON.stringify(variant)}`);\n        await this.changeVariant(this.leftVideo, variant)\n    }\n\n    async onRightVariantChange(variant) {\n        console.log(`right variant changed: ${JSON.stringify(variant)}`);\n        await this.changeVariant(this.rightVideo, variant)\n    }\n\n    async onLeftSourceChange(source) {\n        await this.changeSource(this.leftVideo, source);\n        this.setLeftSource(source);\n        this.splitView.focus();\n    }\n\n    async onRightSourceChange(source) {\n        await this.changeSource(this.rightVideo, source);\n        this.setRightSource(source);\n        this.splitView.focus();\n    }\n\n    async changeVariant(videoElement, variant) {\n        this.pauseAndExecute(videoElement, async () => {\n            this.setState({leftSource: Object.assign({}, this.state.leftSource, {variant})});\n            await videoElement.setVariant(variant);\n            //await this.step(0); // Seek to current time to improve dash switching time?\n        });\n    }\n\n    async changeSource(videoElement, source) {\n        console.log(`Change source ${source.url} ${source.variant}`);\n        this.pauseAndExecute(videoElement, async () => {\n            await videoElement.loadSource(source.url, source.variant);\n        });\n    }\n\n    async pauseAndExecute(videoElement, action) {\n        const wasPlaying = this.state.playing;\n        const wasPlayingReverse = this.state.playReverse;\n        await this.pause();\n        const time = videoElement.currentTime();\n        console.log(`${JSON.stringify(videoElement.props)} time: ${time}`);\n        await action();\n        await this.seek(time);\n        if (wasPlaying) {\n            await this.play();\n        }\n        if (wasPlayingReverse) {\n            await this.playReverse();\n        }\n    }\n\n    zoomIn() {\n        this.leftVideo.zoomIn();\n        this.rightVideo.zoomIn();\n        this.setState({userDefinedPanZoom: true});\n    }\n\n    zoomOut() {\n        this.leftVideo.zoomOut();\n        this.rightVideo.zoomOut();\n        this.setState({userDefinedPanZoom: true});\n    }\n\n    resetPanZoom() {\n        this.leftVideo.resetPanZoom();\n        this.rightVideo.resetPanZoom();\n        this.setState({userDefinedPanZoom: false});\n    }\n\n    pan(deltaX, deltaY) {\n        this.leftVideo.pan(deltaX, deltaY);\n        this.rightVideo.pan(deltaX, deltaY);\n        this.setState({userDefinedPanZoom: true});\n    }\n\n    shortCutHandlers = [\n        [COMMANDS.STEP_FORWARD, () => this.step(25)],\n        [COMMANDS.STEP_FORWARD_FRAME, () => this.step(1)],\n        [COMMANDS.STEP_BACKWARD_FRAME, () => this.step(-1)],\n        [COMMANDS.STEP_BACKWARD, () => this.step(-25)],\n        [COMMANDS.PLAY_PAUSE, () => this.playPause()],\n        [COMMANDS.FULLSCREEN, () => this.fullscreen()],\n        [COMMANDS.TOGGLE_TRACKING, () => this.toggleTracking()],\n        [COMMANDS.LEFT_ONLY, () => this.splitView.setSplitPosition(100)],\n        [COMMANDS.RIGHT_ONLY, () => this.splitView.setSplitPosition(0)],\n        [COMMANDS.TIMESHIFT_INCREASE, () => this.changeOffset(1)],\n        [COMMANDS.TIMESHIFT_DECREASE, () => this.changeOffset(-1)],\n        [COMMANDS.TIMESHIFT_RESET, () => this.changeOffset(0)],\n        [COMMANDS.ZOOM_IN, () => this.zoomIn()],\n        [COMMANDS.ZOOM_OUT, () => this.zoomOut()],\n        [COMMANDS.PAN_UP, () => this.pan(0, 10)],\n        [COMMANDS.PAN_DOWN, () => this.pan(0, -10)],\n        [COMMANDS.PAN_RIGHT, () => this.pan(-10, 0)],\n        [COMMANDS.PAN_LEFT, () => this.pan(10, 0)],\n        [COMMANDS.REST_PAN_ZOOM, () => this.resetPanZoom()],\n        [COMMANDS.SHARE, () => this.createShareUrl()],\n        [COMMANDS.PLAY, () => this.playForward()],\n        [COMMANDS.PAUSE, () => this.pause()],\n        [COMMANDS.TOGGLE_HELP, () => this.toggleShowHelp()],\n        [COMMANDS.TOGGLE_SPLIT_BORDER_VISIBLE, () => this.toggleSplitBorderVisible()]\n    ].reduce((result, [command, action]) => Object.assign(result, {[command.name]: action}), {});\n\n    toggleShowHelp() {\n        this.setState({showHelp: !this.state.showHelp});\n    }\n\n    toggleSplitBorderVisible() {\n        this.setState({splitBorderVisible: !this.state.splitBorderVisible});\n    }\n\n    onFullScreenChange() {\n        if (!this.state.userDefinedPanZoom) {\n            this.resetPanZoom();\n        }\n    }\n\n    componentDidMount() {\n        this.splitView.focus();\n        this.seek(startPosition)\n            .catch(e => console.trace(e));\n        this.videoViewer.addEventListener('fullscreenchange', this.onFullScreenChange);\n    }\n\n    componentWillUnmount(){\n        this.videoViewer.removeEventListener('fullscreenchange', this.onFullScreenChange);\n    }\n\n    render() {\n\n        return (\n            <div className=\"video-viewer\"\n                 tabIndex=\"0\"\n                 ref={this.setVideoViewerRef}>\n                <TimeDisplay position={this.state.position}/>\n                <HotKeys className=\"hotkeys-div\" keyMap={KEY_MAP} handlers={this.shortCutHandlers}>\n                    <SplitView tracking={this.state.tracking}\n                               splitBorderVisible={this.state.splitBorderVisible}\n                               onDrag={(dx,dy) => this.pan(dx,dy)}\n                               onClick={() => this.playPause()}\n                               ref={this.setSplitViewRef}\n                               leftSideContent={(<VideoPlayer muted ref={this.setLeftVideoRef} />)}\n                    >\n\n                        <VideoPlayer ref={this.setRightVideoRef}\n                                     onTimeUpdate={(time) => this.onTimeUpdate(time)}\n                                     onDurationSet={(duration) => this.onDurationSet(duration)}\n                        />\n                        <div className={cx(\"big-play-button\", {\n                            \"hidden\": this.state.playing || this.state.position !== 0\n                        })}\n                             onClick={() => this.play()}\n                        >\n                            <FiPlay size=\"32px\"/>\n                        </div>\n                    </SplitView>\n\n                    <VideoControls visible={this.state.showSourceSelector}\n                                   playing={this.state.playing}\n                                   onPlay={() => this.playPause()}\n                                   onStep={(n) => this.step(n)}\n                                   onFullscreen={() => this.fullscreen()}\n                                   duration={this.state.duration}\n                                   onSeek={(pos) => this.seek(pos)}\n                                   position={this.state.position}\n                    />\n\n                    <SourceSelector visible={this.state.showSourceSelector}\n                                    className=\"left-source-selector\"\n                                    defaultSource={DEFAULT_SOURCE_LEFT}\n                                    onChange={(value) => this.onLeftSourceChange(value)}\n                                    onVariantChange={(value) => this.onLeftVariantChange(value)}/>\n                    <SourceSelector visible={this.state.showSourceSelector}\n                                    className=\"right-source-selector\"\n                                    defaultSource={DEFAULT_SOURCE_RIGHT}\n                                    onChange={(value) => this.onRightSourceChange(value)}\n                                    onVariantChange={(value) => this.onRightVariantChange(value)}/>\n                    <OffsetIndicator offset={this.state.rightVideoOffset}/>\n                    <Help visible={this.state.showHelp} onClick={() => this.toggleShowHelp()} />\n                    <HelpButton onClick={() => this.toggleShowHelp()} />\n                </HotKeys>\n            </div>\n\n        );\n    }\n}\n\nexport default VideoViewer;","export function openFullscreen(elem) {\n    if (elem.requestFullscreen) {\n        elem.requestFullscreen();\n    } else if (elem.mozRequestFullScreen) { /* Firefox */\n        elem.mozRequestFullScreen();\n    } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */\n        elem.webkitRequestFullscreen();\n    } else if (elem.msRequestFullscreen) { /* IE/Edge */\n        elem.msRequestFullscreen();\n    }\n}\n\nexport function isFullscreen() {\n    return document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen;\n}\n\nexport function closeFullscreen() {\n    if (document.exitFullscreen) {\n        document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) { /* Firefox */\n        document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */\n        document.webkitExitFullscreen();\n    } else if (document.msExitFullscreen) { /* IE/Edge */\n        document.msExitFullscreen();\n    }\n}\n","import React, { Component } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\n\nimport VideoViewer from './components/VideoViewer';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <VideoViewer />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}